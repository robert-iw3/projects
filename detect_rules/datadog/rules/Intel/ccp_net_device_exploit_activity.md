### CCP APT Activity Targeting Global Networks
---

CCP APT actors are actively targeting telecommunications, government, transportation, lodging, and military infrastructure networks worldwide to establish persistent access and feed a global espionage system. These actors leverage known vulnerabilities in network edge devices, modify router configurations, and employ custom tools to maintain long-term access and exfiltrate sensitive data.

Recent intelligence indicates continued exploitation of Ivanti, Palo Alto Networks, and Cisco vulnerabilities for initial access, with a focus on maintaining persistence through techniques like modifying Access Control Lists and enabling SSH backdoors. Notably, the use of a Windows kernel-mode rootkit named Demodex by GhostEmperor (also known as Salt Typhoon) highlights a sophisticated approach to evading detection and maintaining deep infiltration.

### Actionable Threat Data
---

Monitor for SSH activity on high, non-default ports (e.g., 22x22 or xxx22 patterns) from non-administrative source IPs, as APT actors enable SSH servers on external-facing ports for encrypted remote access.

Detect the enablement of sshd_operns service on Cisco IOS XR platforms, which listens on TCP/57722 and provides direct shell access to the host Linux OS, as this is disabled by default and used for persistence.

Look for modifications to Access Control Lists (ACLs) that add new, unauthorized IP addresses, especially those named "access-list 20", "50", or "10", as these are used to bypass security policies and maintain access.

Identify the creation of new local users on network devices, particularly those granted sudo privileges via /etc/sudoers or /etc/sudoers.d/ on IOS XR Linux hosts, as this indicates persistence mechanisms.

Hunt for the execution of commands related to packet capture (e.g., monitor capture, span/erspan configuration commands) and the presence of PCAP files with suspicious naming conventions (e.g., mycap.pcap, tac.pcap, 1.pcap), as actors collect network traffic, especially TACACS+ credentials.

### Consolidated Search
---
```sql
-- title: CCP Network Device Activity
-- description: Detects TTPs associated with CCP actors targeting network infrastructure, including enabling backdoors, modifying ACLs, creating users, and capturing traffic.
-- author: RW
-- date: 2025-08-29
-- references: https://www.cisa.gov/news-events/cybersecurity-advisories/aa25-239a
-- tags: persistence, defense_evasion, credential_access, collection, t1021.004, t1562.004, t1136.001, t1040, t1059.008, t1571
-- falsepositives: Legitimate administrative activity may trigger command matches. High-port SSH (xxx22) may match legitimate services. Baseline normal activity and filter known good IPs.
-- level: high

source:cisco OR source:paloalto OR source:linux OR source:firewall
(
    -- Part 1: Suspicious commands and filenames in logs
    "service sshd_operns start"
    OR "access-list 10"
    OR "access-list 20"
    OR "access-list 50"
    OR "useradd cisco"
    OR "vi /etc/sudoers"
    OR "monitor capture"
    OR "mycap.pcap"
    OR "tac.pcap"
    OR "1.pcap"
    OR "span"
    OR "erspan"
    -- Part 2: Suspicious network connections
    OR network.destination.port:57722
    OR network.destination.port:/^\d{3,5}22$/
)
-- FP-Tuning: Add -network.destination.ip:(known_good_ips) to reduce false positives
| by {host, network.source.ip, network.destination.ip, network.destination.port, user}
| select timestamp, message as raw_event,
    case(
        message MATCHES "service sshd_operns start", "Suspicious Service Started: sshd_operns",
        message MATCHES "access-list 10" OR message MATCHES "access-list 20" OR message MATCHES "access-list 50", "Suspicious ACL Modification Detected",
        message MATCHES "useradd cisco", "Suspicious User Creation: cisco",
        message MATCHES "vi /etc/sudoers", "Sudoers File Edited",
        message MATCHES "monitor capture" OR message MATCHES "span" OR message MATCHES "erspan", "Packet/Traffic Capture Command Detected",
        message MATCHES "mycap.pcap" OR message MATCHES "tac.pcap" OR message MATCHES "1.pcap", "Suspicious PCAP Filename Detected",
        network.destination.port = 57722, "Network Connection to IOS XR Backdoor Port 57722",
        network.destination.port MATCHES "^\d{3,5}22$", "Network Connection to High Port Ending in '22'",
        true, "Unknown Match - Check Raw Event"
    ) as reason
```
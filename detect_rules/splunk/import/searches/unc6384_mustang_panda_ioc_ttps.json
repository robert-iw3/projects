[
  {
    "name": "UNC6384 Mustang Panda Campaign IOCs and TTPs",
    "search": "search (index=* tag=endpoint) OR (index=* tag=network) ( (hash_sha256 IN (\"65c42a7ea18162a92ee982eded91653a5358a7129c7672715ce8ddb6027ec124\", \"3299866538aff40ca85276f87dd0cefe4eafe167bd64732d67b06af4f3349916\", \"e787f64af048b9cb8a153a0759555785c8fd3ee1e8efbca312a29f2acb1e4011\", \"cc4db3d8049043fa62326d0b3341960f9a0cf9b54c2fbbdffdbd8761d99add79\", \"d1626c35ff69e7e5bde5eea9f9a242713421e59197f4b6d77b914ed46976b933\") OR file_hash_sha256 IN (\"65c42a7ea18162a92ee982eded91653a5358a7129c7672715ce8ddb6027ec124\", \"3299866538aff40ca85276f87dd0cefe4eafe167bd64732d67b06af4f3349916\", \"e787f64af048b9cb8a153a0759555785c8fd3ee1e8efbca312a29f2acb1e4011\", \"cc4db3d8049043fa62326d0b3341960f9a0cf9b54c2fbbdffdbd8761d99add79\", \"d1626c35ff69e7e5bde5eea9f9a242713421e59197f4b6d77b914ed46976b933\")) OR (dest_ip IN (\"103.79.120.72\", \"166.88.2.90\") OR dest_host=\"mediareleaseupdates.com\") OR (http_user_agent=\"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 10.0; .NET4.0C; .NET4.0E; .NET CLR 2.0.50727; .NET CLR 3.0.30729; .NET CLR 3.5.30729)\") OR (EventCode IN (12,13,14) AND TargetObject=\"*\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\CanonPrinter\" AND Details=\"*cnmpaui.exe*\") OR (EventCode=7 AND Image=\"*\\\\cnmpaui.exe\" AND ImageLoaded=\"*\\\\cnmpaui.dll\") OR (EventCode=1 AND (TargetFilename=\"*\\\\DNVjzaXMFO\\\\*\" OR TargetFilename=\"*C:\\\\Users\\\\Public\\\\Intelnet\\\\*\" OR TargetFilename=\"*C:\\\\Users\\\\Public\\\\SecurityScan\\\\*\")) ) | eval timestamp=strftime(_time, \"%Y-%m-%d %H:%M:%S\") | eval detection_name=case( isnotnull(hash_sha256) OR isnotnull(file_hash_sha256), \"UNC6384 - Malicious File Hash\", isnotnull(dest_ip) OR isnotnull(dest_host), \"UNC6384 - Malicious Network Connection\", match(http_user_agent, \"MSIE 9.0\"), \"UNC6384 - SOGU.SEC User Agent\", EventCode IN (12,13,14), \"UNC6384 - CanonPrinter Persistence\", EventCode=7, \"UNC6384 - CANONSTAGER DLL Sideloading\", EventCode=1, \"UNC6384 - Suspicious File Path\", 1=1, \"UNC6384 - Fallback Match\" ) | eval victim_host=coalesce(host, dvc, dest_host, ComputerName, dest) | eval src_process=coalesce(process, Image, process_name, file_name) | eval user=coalesce(user, User) | eval ioc_indicator=coalesce(hash_sha256, file_hash_sha256, dest_ip, dest_host, http_user_agent, TargetObject, ImageLoaded, TargetFilename) | stats count values(timestamp) as event_times values(detection_name) as detections values(ioc_indicator) as matched_iocs values(src_process) as processes values(user) as users by victim_host | rename victim_host as \"Victim Host\", event_times as \"Event Times\", detections as \"Detections\", matched_iocs as \"Matched IOCs\", processes as \"Associated Processes\", users as \"Associated Users\"",
    "description": "Detects multiple indicators of compromise (IOCs) and tactics, techniques, and procedures (TTPs) associated with a UNC6384 (Mustang Panda) campaign targeting diplomats, as reported by Google in August 2025. This rule covers file hashes, network indicators, persistence mechanisms, and behavioral patterns related to the STATICPLUGIN, CANONSTAGER, and SOGU.SEC malware families.",
    "is_scheduled": 1,
    "disabled": 0,
    "cron_schedule": "*/30 * * * *",
    "dispatch.earliest_time": "-24h",
    "dispatch.latest_time": "now",
    "sharing": "global",
    "acl": {
      "read": ["power", "admin"],
      "write": ["admin"]
    }
  }
]

[
  {
    "name": "Silk Typhoon Attack Indicators",
    "search": "(search (index=* sourcetype=ms:aad:signin OR sourcetype=AzureAD:SignInLogs) user IN (\"*AAD_*\", \"*MSOL_*\") category=signIn | eval user=user, dest=appDisplayName, src_ip=ipaddr, activity=\"Suspicious Interactive Logon by Entra Connect Account\", details=\"User: \" + user + \" from IP: \" + src_ip + \" to App: \" + dest | fields _time, user, dest, src_ip, activity, details) | append [ search (index=* sourcetype=ms:aad:audit OR sourcetype=AzureAD:AuditLogs) category=UserManagement activityDisplayName=\"Reset user password\" result=success initiatedBy.user.userPrincipalName IN (\"*AAD_*\", \"*MSOL_*\") | eval user=initiatedBy.user.userPrincipalName, dest=targetResources{}.userPrincipalName, src_ip=initiatedBy.user.ipAddress, activity=\"Password Reset by Entra Connect Account\", details=\"Entra Connect account \" + user + \" reset password for \" + dest | fields _time, user, dest, src_ip, activity, details ] | append [ search (index=* sourcetype=ms:aad:audit OR sourcetype=AzureAD:AuditLogs) category=ApplicationManagement (activityDisplayName=\"Add service principal\" OR activityDisplayName=\"Add OAuth2 permission grant\" OR activityDisplayName=\"Add owner to service principal\" OR activityDisplayName=\"Update application - Certificates and secrets management\") | eval user=initiatedBy.user.userPrincipalName, dest=targetResources{}.displayName, src_ip=initiatedBy.user.ipAddress, activity=activityDisplayName, details=\"User \" + user + \" performed action '\" + activity + \"' on application \" + dest | fields _time, user, dest, src_ip, activity, details ] | append [ search (index=* sourcetype=o365:management:activity) (Operation=MailItemsAccessed OR Operation=FileDownloaded) | stats dc(ObjectId) as accessed_items_count by _time, User as user, ClientIP as src_ip, AppId, Operation | where accessed_items_count > 100 | eval activity=\"Potential High-Volume Data Access\", dest=AppId, details=\"User \" + user + \" accessed \" + accessed_items_count + \" items via \" + Operation + \" using AppId \" + AppId | fields _time, user, dest, src_ip, activity, details ] | append [ search (index=* sourcetype=sysmon EventCode=1) OR (index=* sourcetype IN (crowdstrike:falcon:process_creation, carbonblack:process, microsoft:windows:security:4688)) | eval user=coalesce(UserName, user_name, User), dest=coalesce(ComputerName, host, dvc_host), parent_process=coalesce(ParentImage, ParentProcessName, ParentBaseFileName), process=coalesce(Image, FileName, NewProcessName), cmdline=coalesce(CommandLine, ProcessCommandLine) | search parent_process IN (\"*\\\\w3wp.exe\", \"*\\\\httpd.exe\", \"*\\\\nginx.exe\", \"*\\\\tomcat*.exe\") process IN (\"*\\\\cmd.exe\", \"*\\\\powershell.exe\", \"*\\\\pwsh.exe\", \"*\\\\sh\", \"*\\\\bash\") | eval activity=\"Potential Web Shell Execution\", details=\"Parent: \" + parent_process + \" spawned Child: \" + process + \". Command: \" + cmdline | fields _time, user, dest, activity, details ] | append [ search (index=* sourcetype IN (tenable:sc, qualys:vm, nessus:scan)) cve IN (\"CVE-2025-0282\", \"CVE-2024-3400\", \"CVE-2023-3519\", \"CVE-2021-26855\", \"CVE-2021-26857\", \"CVE-2021-26858\", \"CVE-2021-27065\") | eval activity=\"Vulnerable Device Identified\", dest=coalesce(host, dest_host, dest), details=\"Device \" + dest + \" is vulnerable to \" + cve + \" (Plugin/Signature: \" + coalesce(signature, plugin_name, signature_id) + \")\", user=\"N/A\", src_ip=\"N/A\" | fields _time, user, dest, src_ip, activity, details ] | table _time, activity, user, src_ip, dest, details",
    "description": "Detects indicators of compromise (IOCs) and tactics, techniques, and procedures (TTPs) associated with the Silk Typhoon threat actor, targeting Microsoft Azure Active Directory (now Entra ID), Office 365, and vulnerable systems.",
    "is_scheduled": 1,
    "disabled": 0,
    "cron_schedule": "*/30 * * * *",
    "dispatch.earliest_time": "-24h",
    "dispatch.latest_time": "now",
    "sharing": "global",
    "acl": {
      "read": ["power", "admin"],
      "write": ["admin"]
    }
  }
]

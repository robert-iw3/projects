[
  {
    "name": "QuirkyLoader Detection Search",
    "search": "(index=* (tag=process OR tag=network)) ( (process_name IN (\"AddInProcess32.exe\", \"InstallUtil.exe\", \"aspnet_wp.exe\")) OR (file_hash IN (\"011257eb766f2539828bdd45f8aa4ce3c4048ac2699d988329783290a7b4a0d3\", \"0ea3a55141405ee0e2dfbf333de01fe93c12cf34555550e4f7bb3fdec2a7673b\", \"a64a99b8451038f2bbcd322fd729edf5e6ae0eb70a244e342b2f8eff12219d03\", \"9726e5c7f9800b36b671b064e89784fb10465210198fbbb75816224e85bd1306\", \"a1994ba84e255eb02a6140cab9fc4dd9a6371a84b1dd631bd649525ac247c111\", \"d954b235bde6ad02451cab6ee1138790eea569cf8fd0b95de9dc505957c533cd\", \"5d5b3e3b78aa25664fb2bfdbf061fc1190310f5046d969adab3e7565978b96ff\", \"6f53c1780b92f3d5affcf095ae0ad803974de6687a4938a2e1c9133bf1081eb6\", \"ea65cf2d5634a81f37d3241a77f9cd319e45c1b13ffbaf5f8a637b34141292eb\", \"1b8c6d3268a5706fb41ddfff99c8579ef029333057b911bb4905e24aacc05460\", \"d0a3a1ee914bcbfcf709d367417f8c85bd0a22d8ede0829a66e5be34e5e53bb9\", \"b22d878395ac2f2d927b78b16c9f5e9b98e006d6357c98dbe04b3fd78633ddde\", \"a83aa955608e9463f272adca205c9e1a7cbe9d1ced1e10c9d517b4d1177366f6\", \"3391b0f865f4c13dcd9f08c6d3e3be844e89fa3afbcd95b5d1a1c5abcacf41f4\", \"b2fdf10bd28c781ca354475be6db40b8834f33d395f7b5850be43ccace722c13\", \"bf3093f7453e4d0290511ea6a036cd3a66f456cd4a85b7ec8fbfea6b9c548504\", \"97aee6ca1bc79064d21e1eb7b86e497adb7ece6376f355e47b2ac60f366e843d\", \"b42bc8b2aeec39f25babdcbbdaab806c339e4397debfde2ff1b69dca5081eb44\", \"5aaf02e4348dc6e962ec54d5d31095f055bd7fb1e58317682003552fd6fe25dc\", \"8e0770383c03ce69210798799d543b10de088bac147dce4703f13f79620b68b1\", \"049ef50ec0fac1b99857a6d2beb8134be67ae67ae134f9a3c53699cdaa7c89ac\", \"cba8bb455d577314959602eb15edcaa34d0b164e2ef9d89b08733ed64381c6e0\")) OR (query IN (\"catherinereynolds.info\", \"mail.catherinereynolds.info\")) OR (dest_ip IN (\"157.66.22.11\", \"103.75.77.90\", \"161.248.178.212\")) ) | stats count, values(process_name) as processes_observed, values(process) as process_command_lines, values(parent_process) as parent_processes, values(file_hash) as matched_hashes, values(query) as dns_queries, values(dest_ip) as destination_ips, earliest(_time) as first_seen, latest(_time) as last_seen by dest, user | eval detection_reason = case(mvcount(matched_hashes) > 0, \"IOC Match: Known QuirkyLoader file hash detected.\", mvcount(dns_queries) > 0 OR mvcount(destination_ips) > 0, \"IOC Match: Network connection to QuirkyLoader C2 detected.\", mvcount(processes_observed) > 0, \"TTP Match: Execution of a known QuirkyLoader process hollowing target.\") | convert ctime(first_seen) ctime(last_seen) | table dest, user, detection_reason, processes_observed, parent_processes, process_command_lines, matched_hashes, dns_queries, destination_ips, first_seen, last_seen, count",
    "description": "Detects QuirkyLoader malware activity based on process hollowing, known file hashes, and network C2 communication.",
    "is_scheduled": 1,
    "disabled": 0,
    "cron_schedule": "*/30 * * * *",
    "dispatch.earliest_time": "-24h",
    "dispatch.latest_time": "now",
    "sharing": "global",
    "acl": {
      "read": ["power", "admin"],
      "write": ["admin"]
    }
  }
]

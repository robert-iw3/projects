### MongoBleed (CVE-2025-14847) Information Leak
---

A high-severity vulnerability nicknamed MongoBleed (CVE-2025-14847) allows unauthenticated attackers to remotely leak sensitive memory from vulnerable MongoDB servers. This flaw is being actively exploited in the wild, making it critical for organizations with self-hosted instances to take immediate action.

Exploitation of MongoBleed can be detected by identifying distinct behavioral anomalies in server logs. Unlike legitimate connections, the exploit generates massive connection bursts (50,000-100,000 per minute) from a single source IP and fails to send client metadata (event ID 51800), providing a high-fidelity method for creating detections. An open-source log analysis tool is now available to help defenders scan for these specific indicators of compromise.

### Actionable Threat Data
---

Exploitation involves sending a malformed, compressed network packet that causes the server to return uninitialized heap memory before authentication is performed.

Detection efforts should focus on monitoring MongoDB logs for an unusually high number of rapid connections and disconnections from a single IP address that lack corresponding client metadata (event ID 51800).

Look for CPU and memory spikes correlated with large data requests from an unauthenticated IP address. Enabling verbose command logging may reveal BSON parsing errors associated with exploit attempts.

Affected MongoDB server versions include 8.2.0-8.2.2, 8.0.0-8.0.16, 7.0.0-7.0.27, 6.0.0-6.0.26, 5.0.0-5.0.31, 4.4.0-4.4.29, and all end-of-life versions (4.2, 4.0, 3.6).

As a temporary mitigation if patching is not possible, disable zlib compression by explicitly omitting "zlib" from the networkMessageCompressors or net.compression.compressors server configuration.

### MongoBleed High Connection Rate
---

```sql
`comment("Name: MongoBleed High Connection Rate")`
`comment("Author: RW")`
`comment("Date: 2026-01-03")`
`comment("Description: This detection identifies an anomalously high number of connection attempts to a MongoDB server (default port 27017, change port if using embedded mongodb) from a single source IP. This behavior is characteristic of the MongoBleed (CVE-2025-14847) exploit, which can involve tens of thousands of connections per minute.")`
`comment("MITRE ATT&CK: T1190")`
`comment("References: https://www.wiz.io/blog/mongobleed-cve-2025-14847-exploited-in-the-wild-mongodb")`

`comment("Use the tstats command for performance against the Network_Traffic data model.")`
| tstats `summariesonly` count from datamodel=Network_Traffic where All_Traffic.dest_port=27017 by _time, All_Traffic.src_ip, All_Traffic.dest_ip span=1m

`comment("Set the threshold for the number of connections. The public exploit can generate 50k-100k connections/min. A threshold of 1000 is a high-confidence starting point but may need tuning based on your environment's baseline.")`
| where count > 1000

`comment("Rename fields for better readability and compatibility with downstream actions.")`
| rename "All_Traffic.*" as *

`comment("This is a placeholder for filtering out known false positives. For example, you might want to exclude legitimate application servers or scanners that generate high connection volumes.")`
`comment("Example: | where src_ip NOT IN (\"10.1.1.0/24\", \"172.16.0.0/16\")")`
| `mongobleed_high_connection_rate_filter`

`comment("Structure the final output for alerting.")`
| table _time, src_ip, dest_ip, count
| `security_content_summaries`
```

### MongoBleed Missing Client Metadata
---

```sql
`comment("Name: MongoBleed Missing Client Metadata")`
`comment("Author: RW")`
`comment("Date: 2026-01-03")`
`comment("Description: This detection identifies MongoDB connections that are established and terminated without sending the client metadata payload (event ID 51800). This specific behavior is a high-fidelity indicator of the MongoBleed (CVE-2025-14847) exploit, as the public proof-of-concept code omits this step, which is standard for all legitimate drivers.")`
`comment("MITRE ATT&CK: T1190")`
`comment("References: https://www.wiz.io/blog/mongobleed-cve-2025-14847-exploited-in-the-wild-mongodb")`

`comment("This search assumes MongoDB logs are ingested, ideally in JSON format. Adjust the index and sourcetype to match your environment, e.g., sourcetype=mongodb:json.")`
`comment("The logic requires extracting a connection ID (e.g., from a 'ctx' field like 'conn123') and the remote IP.")`
`sourcetype=mongodb* (msg="connection accepted" OR msg="end connection" OR id=51800)`

`comment("Extract the connection ID and source IP. These extractions may need to be adjusted based on your specific log format.")`
| rex field=_raw "\[conn(?<conn_id>\d+)\]"
| rex field=_raw "connection accepted from (?<src_ip>[^:]+):\d+"

`comment("Create flags for each event type to identify the stages of a connection.")`
| eval is_accepted=if(like(_raw, "%connection accepted%"), 1, 0), is_ended=if(like(_raw, "%end connection%"), 1, 0), has_metadata=if(match(_raw, "id.:51800"), 1, 0)

`comment("Group events by connection ID to analyze the lifecycle of each connection.")`
| stats values(src_ip) as src_ip, sum(is_accepted) as accepted_count, sum(is_ended) as ended_count, sum(has_metadata) as metadata_count by conn_id

`comment("Filter for connections that were accepted and ended but are missing the client metadata event.")`
| where accepted_count > 0 AND ended_count > 0 AND metadata_count == 0

`comment("Clean up the src_ip field and remove events where an IP could not be extracted.")`
| eval src_ip=mvindex(src_ip, 0)
| where isnotnull(src_ip)

`comment("Count the number of suspicious connections per source IP.")`
| stats count as suspicious_connections by src_ip

`comment("Alert if a single source IP is responsible for multiple suspicious connections. A threshold of 10 is a good starting point for high-fidelity alerts.")`
| where suspicious_connections > 10

`comment("Structure the final output for alerting.")`
| rename src_ip as "Source IP", suspicious_connections as "Suspicious Connection Count"
| `security_content_summaries`
```

### MongoBleed Vulnerable Configuration
---

```sql
`comment("Name: MongoBleed Vulnerable Configuration")`
`comment("Author: RW")`
`comment("Date: 2026-01-03")`
`comment("Description: Proactively identifies MongoDB servers with a configuration vulnerable to MongoBleed (CVE-2025-14847). This search looks for mongod.conf files where the 'zlib' compression library is enabled, which is the root cause of the vulnerability.")`
`comment("MITRE ATT&CK: N/A (This is a configuration/vulnerability check, not a direct detection of adversary behavior.)")`
`comment("References: https://www.wiz.io/blog/mongobleed-cve-2025-14847-exploited-in-the-wild-mongodb")`

`comment("Specify the index and sourcetype where configuration files are stored. This may require customization for your environment (e.g., sourcetype=osquery, sourcetype=linux_config).")`
`search index=* (source="*/mongod.conf" OR sourcetype=mongod_conf)`

`comment("Use regex to find active (non-commented) configuration lines enabling 'zlib' compression. This handles different YAML formatting and key names.")`
| regex _raw="(?im)^\s*[^#].*(networkMessageCompressors\s*:\s*.*zlib|compressors\s*:\s*.*zlib)"

`comment("Potential False Positives: This search may trigger if the pattern is found in a context other than the intended configuration, although the regex is designed to minimize this. Use the filter macro below to exclude known-good hosts or specific file paths.")`
| `mongobleed_vulnerable_configuration_filter`

`comment("Group by host to identify unique vulnerable systems.")`
| stats count by host, source

`comment("Rename fields for clarity in the alert.")`
| rename host as "Vulnerable Host", source as "Configuration File"
| `security_content_summaries`
```
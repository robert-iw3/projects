### PANW Firewall Unauthorized Config Change
---

Detects unauthorized modifications to the Palo Alto Networks firewall configuration, potentially indicating malicious activity or security policy violations. These changes can be leveraged to evade detection, facilitate data exfiltration, or disrupt network defenses, ultimately compromising the integrity and security of the environment.

T1562.004 - Disable or Modify System Firewall

T1562 - Impair Defenses

TA0005 - Defense Evasion

TA0040 - Impact

```sql
index=* sourcetype="pan:config" result="Unauthorized"
| stats count by host, user, result, object
| where count > 0
```

### PANW Firewall Traffic to Phishing URL Allowed

Detects when the Palo Alto Networks firewall does not block traffic to a URL known to be used in phishing attacks. An adversary can abuse this by directing victims to the phishing site, potentially stealing credentials, deploying malware, or conducting other malicious activities.

T1566 - Phishing

TA0001 - Initial Access

```sql
index=* sourcetype="pan:threat" subtype="url" (threat_category="phishing" OR url_category="phishing") severity IN ("critical", "high", "medium") NOT (action IN ("deny", "drop", "reset", "block"))
| stats count by src_ip, dest_ip, url, threat_name, action, severity
| where count > 0
```

### PANW Firewall Traffic to Malicious URL Allowed

Detects when the Palo Alto Networks firewall does not block traffic to a URL associated with malware distribution or operation. This typically indicates a lapse in the firewall's threat intelligence or a misconfiguration. An adversary can abuse this by using the unblocked URL to download malware onto a target system, establish a command and control channel, or exfiltrate data.

S0183 - Tor

TA0011 - Command and Control

```sql
index=* sourcetype="pan:traffic" (app="tor" OR app_name="tor") action="allow"
| stats count by src_ip, dest_ip, app, action, bytes_sent, bytes_received
| where count > 0
```

### PANW Firewall TOR Traffic Allowed

Detects allowed network traffic to the TOR network. Adversaries can use TOR to anonymize their network activity, bypass security controls, and evade detection while conducting malicious operations. This could lead to unauthorized access, data exfiltration, and compliance violations if deemed malicious.

S0183 - Tor

```sql
index=* sourcetype="pan:traffic" (app="tor" OR app_name="tor") action="allow"
| stats count by src_ip, dest_ip, app, action, bytes_sent, bytes_received
| where count > 0
```

### PANW Firewall Medium Severity Correlation Event Detected

Detects medium severity correlation events generated by Palo Alto Networks firewall's automated correlation engine. The correlation engine connects isolated network events and looks for patterns that indicate a more significant event. This helps identify suspicious traffic patterns and network anomalies which, when correlated, indicate with a high probability that a host on the network has been compromised.

```sql
index=* sourcetype="pan:correlation" severity="medium"
| stats count by src_ip, dest_ip, threat_name, severity, correlation_type
| where count > 0
```

### PANW Firewall Malware Allowed

Detects active network communication associated with known malware that is being allowed by the Palo Alto Networks firewall. This may indicate an ongoing security threat, where malicious traffic is bypassing firewall protections, potentially leading to system compromise, data exfiltration, or further infiltration within the network.

T1588.001 - Malware

TA0011 - Command and Control

TA0042 - Resource Development

```sql
index=* sourcetype="pan:threat" subtype="virus" NOT (action IN ("deny", "drop", "reset", "block"))
| stats count by src_ip, dest_ip, threat_name, action, severity
| where count > 0
```

### PANW Firewall High Severity Correlation Event Detected

Detects high and critical severity correlation events generated by Palo Alto Networks firewalls' automated correlation engine. The correlation engine connects isolated network events and looks for patterns that indicate a more significant event. This helps identify suspicious traffic patterns and network anomalies which, when correlated, indicate with a high probability that a host on the network has been compromised.

```sql
index=* sourcetype="pan:correlation" severity IN ("high", "critical")
| stats count by src_ip, dest_ip, threat_name, severity, correlation_type
| where count > 0
```

### Exploitation of Windows Server Update Services Remote Code Execution Vulnerability (CVE-2025-59287)
---

Threat actors are actively exploiting CVE-2025-59287, a critical deserialization vulnerability in Microsoft Windows Server Update Services (WSUS), to achieve remote code execution and exfiltrate sensitive information. This vulnerability allows unauthenticated attackers to execute arbitrary code with SYSTEM privileges by sending specially crafted requests to exposed WSUS instances.

Microsoft has released an out-of-band update to address CVE-2025-59287, as the initial Patch Tuesday fix was incomplete. This vulnerability has been added to CISA's Known Exploited Vulnerabilities Catalog, underscoring its critical nature and active exploitation in the wild.

### Actionable Threat Data
---

Monitor for cmd.exe or powershell.exe being spawned as child processes of w3wp.exe or wsusservice.exe. (T1059.001, T1059.003)

Detect PowerShell execution with base64 encoded commands, especially those attempting to enumerate network or user information and exfiltrate data to remote webhooks. (T1059.001, T1059.003, T1082, T1033, T1071.001)

Look for unusual outbound network connections from WSUS servers, particularly to webhook.site or other suspicious domains, indicating data exfiltration. (T1071.001)

Inspect WSUS log files (C:\Program Files\Update Services\Logfiles\SoftwareDistribution.log and C:\inetpub\logs\LogFiles\W3SVC*\u_ex*.log) for errors related to deserialization or unexpected POST requests to WSUS web services like /ReportingWebService/ReportingWebService.asmx or /ClientWebService/Client.asmx. (T1059.001, T1059.003)

Identify curl.exe or iwr (Invoke-WebRequest) commands used for data exfiltration, especially when originating from WSUS-related processes. (T1071.001)

### Consolidated TTP Search
---
```sql
-- Description: This query detects suspicious child processes and network connections originating from the Windows Server Update Services (WSUS) service process (wsusservice.exe) or the associated IIS worker process (w3wp.exe). This behavior is indicative of post-exploitation activity related to CVE-2025-59287, a remote code execution vulnerability in WSUS. The detection looks for command-line enumeration, encoded PowerShell commands, and data exfiltration to webhook sites.
-- References: https://www.huntress.com/blog/exploitation-of-windows-server-update-services-remote-code-execution-vulnerability
-- False Positive Sensitivity: Medium
-- Tags: CVE-2025-59287, WSUS, RCE, Exfiltration, PowerShell, w3wp.exe, wsusservice.exe

-- Part 1: Suspicious Child Processes
FROM logs-*
| WHERE process.parent.name IN ("wsusservice.exe", "w3wp.exe")
| WHERE (
    (process.name == "powershell.exe" AND (
        process.command_line LIKE "*net user /domain*" OR
        process.command_line LIKE "*ipconfig /all*" OR
        process.command_line LIKE "*webhook.site*" OR
        process.command_line LIKE "*iwr -UseBasicParsing*" OR
        process.command_line LIKE "*curl.exe*" OR
        process.command_line LIKE "*-e *" OR
        process.command_line LIKE "*-en *" OR
        process.command_line LIKE "*-enc *" OR
        process.command_line LIKE "*-encodedcommand *"
    )) OR
    (process.name == "cmd.exe" AND (
        process.command_line LIKE "*net user /domain*" OR
        process.command_line LIKE "*ipconfig /all*" OR
        process.command_line LIKE "*webhook.site*" OR
        process.command_line LIKE "*iwr -UseBasicParsing*" OR
        process.command_line LIKE "*curl.exe*"
    )) OR
    (process.name == "curl.exe" AND process.command_line LIKE "*webhook.site*")
)
| EVAL detection_method = "Suspicious Child Process",
        parent_process_cmd = process.parent.command_line,
        child_process_cmd = process.command_line
| KEEP @timestamp, host.name, user.name, detection_method, process.parent.name, parent_process_cmd, process.name, child_process_cmd
| RENAME host.name AS host, user.name AS account, process.parent.name AS parent_process_name, process.name AS process_name

-- Combine with Part 2: Suspicious Network Connections
| UNION (
    FROM logs-*
    | WHERE process.name IN ("wsusservice.exe", "w3wp.exe") AND url.full LIKE "*webhook.site*"
    | EVAL detection_method = "Suspicious Network Connection",
            parent_process_name = process.name,
            parent_process_cmd = "N/A",
            process_name = "N/A",
            child_process_cmd = url.full
    | KEEP @timestamp, host.name, user.name, detection_method, parent_process_name, parent_process_cmd, process_name, child_process_cmd
    | RENAME host.name AS host, user.name AS account
)
| SORT @timestamp DESC
```
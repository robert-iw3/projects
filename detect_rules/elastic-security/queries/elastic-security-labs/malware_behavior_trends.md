<p align="center">
  <img src="https://www.elastic.co/security-labs/grid.svg" />
</p>

## Unveiling Malware Behavior Trends

## Tactics

Beginning with tactics, we aggregated the alerts generated by this corpus of malware samples and organized them according to the counts of process.entity_id and alerts. As depicted in the image below, the most frequent tactics included defense evasion, privilege escalation, execution, and persistence. Certain tactics commonly linked with post-exploitation activities, such as lateral movement, provided an anticipated lower prevalence because these actions are commonly manually driven by the threat actor after the initial implant is established vs. being automated by the malware in our dataset.

```sql
from logs-*
    | where event.code == "behavior"
    | stats alerts_count = count(*), unique_pids_count = count_distinct(process.entity_id), rules_count = count_distinct(rule.name) by threat.tactic.name
    | sort alerts_count desc
```

From our shellcode alerts we can clearly see that self-injection is more prevalent than remote:

```sql
from logs*
    | where event.code == "shellcode_thread"
    | stats alerts = count(*), unique_pids = count.distinct(process.entity_id), unique_hashes = count_distinct(process.hash.sha256) by Memory_protection.self_injection
    | sort unique_pids desc
    | limit 10
```
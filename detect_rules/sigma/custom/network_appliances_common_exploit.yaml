title: Exploitation of Public-Facing Network Appliances
id: 32971cb5-d377-44e6-8c77-2ced64f030e4
status: experimental
description: Detects potential exploitation attempts, such as directory traversal or command injection, against common public-facing network appliances like VPNs and security gateways. This activity is consistent with TTPs used by various threat actors, including those linked to Iran, for initial access.
references: alot
author: Rob Weber
date: 2025-07-27
tags:
  - attack.initial_access
  - attack.t1190
logsource:
  category: proxy
  product: webserver
detection:
  # Detects common URL paths associated with network security appliances
  appliance_paths:
    c-uri|startswith:
      - '/vpns/'                # Citrix
      - '/dana-na/'             # Pulse Secure
      - '/remote/'              # Generic or Fortinet
      - '/sslvpn/'              # Generic or Fortinet
      - '/global-protect/'      # Palo Alto Networks
      - '/tmui/'                # F5 BIG-IP
      - '/clients/'             # Check Point
  # Detects directory traversal patterns in the URI
  traversal:
    c-uri|contains:
      - '../'
      - '..\'
      - '%2e%2e/'
      - '%2e%2e%5c'
      - '..%2f'
  # Detects attempts to access common sensitive files
  sensitive_files:
    c-uri|contains:
      - '/etc/passwd'
      - '/etc/shadow'
      - 'win.ini'
      - 'system.ini'
      - 'web.config'
      - 'smb.conf'
  # Detects common command injection payloads in the URI
  cmd_injection:
    c-uri|contains:
      - 'cmd.exe'
      - '/bin/sh'
      - '/bin/bash'
      - 'powershell'
      - 'whoami'
      - 'uname'
      - 'cat%20/etc/passwd'
      - 'wget%20'
      - 'curl%20'
      - 'bash%20-c'
  condition: appliance_paths and ((traversal and sensitive_files) or cmd_injection)
falsepositives:
  - Legitimate vulnerability scanning tools may trigger this rule.
  - Some administrative actions on the appliances might generate similar patterns. Tuning of appliance paths and command injection strings may be required.
level: high

title: Suspicious Cloud Credential Access
id: 4a9c637e-6076-45af-9923-a41359b3be9c
status: experimental
description: Identifies credential access attempts by monitoring for a high volume of secret retrievals from cloud secret managers, suspicious generation of temporary tokens, or access to sensitive files in cloud storage.
references:
  - Threat Intel ID: 6e487ba759c8e80223efef2a739cd68b6586a6454f568bafdb580d896b47660a
author: RW
date: 2025-08-19
tags:
  - attack.credential_access
  - attack.t1552
logsource:
  category: cloud
detection:
  # Detects retrieval of secrets from cloud secret management services
  secret_retrieval:
    - product: aws
      service: cloudtrail
      aws.eventName: 'GetSecretValue'
    - product: azure
      service: auditlogs
      operationName: 'Microsoft.KeyVault/vaults/secrets/get/action'
    - product: gcp
      service: gcp.audit
      gcp.method_name: 'google.cloud.secretmanager.v1.SecretManagerService.AccessSecretVersion'
  # Detects generation of temporary tokens which can be used for console access or further API calls
  token_generation:
    product: aws
    service: cloudtrail
    aws.eventName:
      - 'GetSessionToken'
      - 'GetFederationToken'
      - 'GetSigninToken'
  # Detects access to files that may contain credentials based on their name
  sensitive_file_access:
    - product: aws
      service: cloudtrail
      aws.eventName: 'GetObject'
      aws.requestParameters.key|contains:
        - 'password'
        - 'secret'
        - 'credential'
        - 'access_key'
        - '.env'
        - 'config'
    - product: gcp
      service: gcp.audit
      gcp.method_name: 'storage.objects.get'
      gcp.resource.name|contains:
        - 'password'
        - 'secret'
        - 'credential'
        - 'access_key'
        - '.env'
        - 'config'
  # This condition detects any of the suspicious activities.
  # For 'secret_retrieval', it is highly recommended to implement a threshold-based alert in your SIEM (e.g., >10 events from the same user in <5 minutes) to detect the "large number" pattern mentioned in the intel.
  # For 'token_generation', it is recommended to filter for source IPs outside of your known corporate network.
  condition: 1 of them
falsepositives:
  - Legitimate administrative scripts or automation that rotate or retrieve multiple secrets.
  - CI/CD pipelines or applications that frequently access secrets as part of their normal operation.
  - Developers or administrators accessing configuration files that match the sensitive keywords.
  - It is crucial to baseline normal activity and tune the detection, for example by allowlisting known service principals or user accounts.
level: medium

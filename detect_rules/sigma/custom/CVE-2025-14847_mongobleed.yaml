title: MongoBleed High Frequency Connection Without Metadata
id: e7e7a95c-e0c8-483b-a2ef-822e37e2867f
status: experimental
description: >-
  Detects a high frequency of MongoDB connections from a single source IP.
  This pattern, when combined with the absence of a client metadata handshake
  (Event ID 51800), is a strong indicator of scanning or exploitation attempts
  related to MongoBleed (CVE-2025-14847).
references:
author: RW
date: 2026-01-09
tags:
  - attack.initial_access
  - attack.t1190
  - cve.2025.14847
logsource:
  product: mongodb
  category: database
detection:
  connection_attempt:
    # Identifies a new connection being accepted by the MongoDB server.
    Message|contains: 'connection accepted from'
  # The 'metadata_sent' selection is provided to define what a legitimate handshake looks like.
  # For high fidelity, use this to filter out or exclude source IPs that are behaving normally.
  metadata_sent:
    EventID: 51800 # This assumes the MongoDB log ID is parsed into an 'EventID' field.
fields:
  - source_ip # The field containing the client IP address. Adjust field name if necessary.
falsepositives:
  - Misconfigured high-volume applications or health checks might trigger this rule. The threshold is set high to reduce this, but may require tuning. For best results, use this rule to alert on source IPs that have no corresponding 'metadata_sent' events.
level: high
# The condition counts connection attempts per source IP over a 1-minute window.
# A count greater than 50 from a single source is highly anomalous and suspicious.
condition: connection_attempt | count() by source_ip > 50
timeframe: 1m

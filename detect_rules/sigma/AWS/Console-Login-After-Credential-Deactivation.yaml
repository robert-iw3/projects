title: AWS Console Login by Federated User
description: |
  Detects a successful AWS Management Console login by a federated user whose session was derived from an IAM user. This is a key step in a persistence technique where an adversary can maintain access via a federated console session even after the originating IAM user's API keys have been deactivated.
references:
  - https://www.crowdstrike.com/en-us/blog/how-adversaries-persist-with-aws-user-federation/
author: RW
date: 2025-08-19
tags:
  - attack.t1136
  - attack.t1098.001
logsource:
  product: aws
  service: cloudtrail
detection:
  selection:
    # Event for a successful console login
    eventName: 'ConsoleLogin'
    responseElements.ConsoleLogin: 'Success'
    # The identity is a federated user
    userIdentity.type: 'FederatedUser'
    # The session was created from an IAM user, which is specific to this technique
    userIdentity.sessionContext.sessionIssuer.type: 'IAMUser'
  condition: selection
falsepositives:
  - This activity may be legitimate in environments that use custom identity brokers or proxy applications that federate from IAM users to grant console access. It is important to baseline this behavior and investigate logins from unexpected or recently compromised IAM users.
level: medium

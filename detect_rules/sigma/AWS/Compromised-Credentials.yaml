title: AWS Initial Reconnaissance via Enumeration API Calls
id: 32368da8-1541-47a5-8b20-645598131821
status: experimental
description: Detects a sequence of reconnaissance API calls commonly performed by an attacker after gaining initial access to AWS credentials. This behavior is documented in pentesting guides as the first step to understand the context of the compromised credentials.
references:
  - https://cloud.hacktricks.wiki/en/pentesting-cloud/aws-security/index.html
author: RW
date: 2025-08-19
tags:
  - attack.reconnaissance
  - attack.t1613
  - attack.t1592
  - cloud
  - aws
logsource:
  service: aws.cloudtrail
  category: cloud
detection:
  selection:
        # List of common initial enumeration calls
    eventName:
      - 'GetCallerIdentity'
      - 'GetUser'
      - 'GetAccessKeyInfo'
      - 'ListAccountAliases'
    errorCode:          # Filter for successful API calls only
    # Timeframe for the correlation
  timeframe: 5m
    # Condition to detect at least 2 distinct enumeration calls from the same identity
  condition: selection | count(distinct eventName) by userIdentity.arn >= 2
falsepositives:
  - Legitimate administrative scripts or automation tools (e.g., Terraform, CI/CD pipelines) may perform these actions for operational purposes.
  - Monitoring or compliance scanning tools.
  - It is recommended to baseline normal activity and exclude known benign roles or user agents.
level: medium

title: AWS GuardDuty EC2 Instance Credential Exfiltration
id: f221b560-6b87-42d5-8e08-eb91ae7b7940
status: experimental
description: Detects Amazon GuardDuty findings indicating that EC2 instance credentials are being used from a location outside of the EC2 instance, either from within AWS or from an external network. This is a strong indicator of credential compromise.
references:
  - https://aws.amazon.com/blogs/aws/amazon-guardduty-enhances-detection-of-ec2-instance-credential-exfiltration/
  - https://hackingthe.cloud/aws/avoiding-detection/steal-keys-undetected/
author: RW
date: 2025-08-19
tags:
  - attack.t1552.001
  - attack.credential_access
logsource:
  product: aws
  service: guardduty
detection:
  selection:
    # This GuardDuty finding type specifically identifies EC2 instance credentials used from an unexpected location.
    # The startswith modifier covers variants like .InsideAWS and .OutsideAWS.
    type|startswith: 'CredentialAccess:IAMUser/InstanceCredentialExfiltration'
  condition: selection
falsepositives:
  - This is a high-fidelity alert from AWS GuardDuty and typically indicates a true positive.
  - In rare cases, legitimate but unusual developer or administrative activity might trigger this finding. All alerts should be investigated.
level: high

title: AWS Bedrock Interaction from Unusual User Agent
id: da531d53-8c62-4f47-9263-401cdf1baf41
status: experimental
description: Detects when a long-lived AWS access key (AKIA*) interacts with AWS Bedrock services using a User-Agent commonly associated with web browsers ('Mozilla') or with no User-Agent at all. This is anomalous because programmatic access typically uses SDK-specific User-Agents (e.g., 'Boto3', 'aws-sdk-go'). This pattern can indicate that a compromised key is being used manually or with simple scripts by an attacker.
references:
  - https://permiso.io/blog/exploiting-hosted-models
author: RW
date: 2025-08-19
tags:
  - attack.t1078.004
  - cloud
  - aws
logsource:
  product: aws
  service: cloudtrail
detection:
  selection_base:
        # Detects interactions with the Bedrock service
    eventSource: 'bedrock.amazonaws.com'
        # Focus on long-lived access keys, not temporary credentials from roles
    userIdentity.type: 'IAMUser'
    userIdentity.accessKeyId: 'AKIA*'
  selection_mozilla:
        # A User-Agent for a browser is highly suspicious for programmatic access with a static key
    userAgent|contains: 'Mozilla'
  filter_ua_not_exists:
        # A non-existent User-Agent is also suspicious for API calls
    userAgent:
  condition: selection_base and (selection_mozilla or filter_ua_not_exists)
falsepositives:
  - Legitimate administrative scripts that intentionally mimic a browser User-Agent.
  - Rare cases of tools or scripts that do not set a User-Agent when making API calls.
  - Consider excluding known good automation user ARNs or source IPs.
level: medium

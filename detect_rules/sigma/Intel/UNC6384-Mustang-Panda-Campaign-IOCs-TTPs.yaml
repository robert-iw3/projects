title: UNC6384 Mustang Panda Campaign IOCs and TTPs
id: 1c851b18-8bac-4924-9c8f-56fe7fb9aba0
status: experimental
description: >-
  Detects multiple indicators of compromise (IOCs) and tactics, techniques, and procedures (TTPs) associated with a UNC6384 (Mustang Panda) campaign targeting diplomats, as reported by Google in August 2025.
  This rule covers file hashes, network indicators, persistence mechanisms, and behavioral patterns related to the STATICPLUGIN, CANONSTAGER, and SOGU.SEC malware families.
references:
  - https://cloud.google.com/blog/topics/threat-intelligence/prc-nexus-espionage-targets-diplomats
author: RW
date: 2025-08-26
tags:
  - attack.execution
  - attack.persistence
  - attack.command_and_control
  - attack.defense_evasion
  - attack.t1204.002
  - attack.t1574.002
  - attack.t1547.001
  - attack.t1071.001
  - threat_actor.unc6384
  - threat_actor.mustang_panda
  - malware.staticplugin
  - malware.canonstager
  - malware.sogu
logsource:
  category:
    - file_event
    - network_connection
    - proxy
    - registry_set
    - image_load
  product: windows
detection:
  # High-fidelity file hash indicators
  hashes:
    file.hash.sha256:
      - '65c42a7ea18162a92ee982eded91653a5358a7129c7672715ce8ddb6027ec124' # STATICPLUGIN (AdobePlugins.exe)
      - '3299866538aff40ca85276f87dd0cefe4eafe167bd64732d67b06af4f3349916' # MSI Package (20250509.bmp)
      - 'e787f64af048b9cb8a153a0759555785c8fd3ee1e8efbca312a29f2acb1e4011' # CANONSTAGER (cnmpaui.dll)
      - 'cc4db3d8049043fa62326d0b3341960f9a0cf9b54c2fbbdffdbd8761d99add79' # Encrypted SOGU.SEC (cnmplog.dat)
      - 'd1626c35ff69e7e5bde5eea9f9a242713421e59197f4b6d77b914ed46976b933' # SOGU.SEC (memory only)
  # Network indicators for C2 and payload hosting
  network:
    destination.ip:
      - '103.79.120.72' # Hosting IP
      - '166.88.2.90'   # C2 IP
    destination.domain:
      - 'mediareleaseupdates.com'
  # Specific User-Agent used by SOGU.SEC
  user_agent:
    http.user_agent: 'Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 10.0; .NET4.0C; .NET4.0E; .NET CLR 2.0.50727; .NET CLR 3.0.30729; .NET CLR 3.5.30729)'
  # Persistence via Run key
  persistence:
    registry.path|endswith: '\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\CanonPrinter'
    registry.data.strings|contains: 'cnmpaui.exe'
  # DLL side-loading TTP
  sideloading:
    process.executable|endswith: '\cnmpaui.exe'
    image.path|endswith: '\cnmpaui.dll'
  # Suspicious file paths used by the malware
  paths:
    file.path|contains:
      - '\DNVjzaXMFO\'
      - 'C:\Users\Public\Intelnet\'
      - 'C:\Users\Public\SecurityScan\'
  condition: 1 of them
falsepositives:
  - The persistence detection may trigger on legitimate Canon printer software. Investigate the associated file ('cnmpaui.exe') and its execution chain.
  - The DLL side-loading pattern is specific, but could potentially occur if a legitimate version of 'cnmpaui.exe' is exploited.
  - The file paths in 'C:\Users\Public\' are somewhat generic and may require tuning based on environment specifics.
level: high

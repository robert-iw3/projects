title: JDWP Exploitation Leading to 'logrotate' XMRig Miner
id: 4ceaaf71-011b-4b33-89ca-571798af4642
status: experimental
description: >-
  Detects TTPs and IOCÂ´s associated with a cryptomining campaign that exploits
  exposed Java Debug Wire Protocol (JDWP) services. Attackers gain remote code
  execution to download and execute a dropper script (`logservice.sh`), which in
  turn deploys a modified XMRig miner disguised as `logrotate`. The malware
  establishes persistence through multiple methods, including systemd services,
  cron jobs, and shell startup scripts.
references:
  - https://www.wiz.io/blog/exposed-jdwp-exploited-in-the-wild
author:
date: 2025-07-09
tags:
  - attack.initial_access
  - attack.t1190
  - attack.execution
  - attack.t1059.004
  - attack.persistence
  - attack.t1543.002
  - attack.t1053.003
  - attack.defense_evasion
  - attack.t1070.004
  - attack.resource_hijacking
logsource:
  - product: linux
    category: process_creation
  - category: network_connection
detection:
  selection_miner_exec:
    Image|endswith: '/.config/logrotate' # Detects execution of the miner from its non-standard installation path.
  selection_payload_download:
    Image|endswith:
      - '/curl'
      - '/wget'
    CommandLine|contains:
      # Detects download of payloads from known malicious servers.
      - '185.196.8.123'
      - '185.196.8.86'
      - 'awarmcorner.world'
      - 'aheatcorner.world'
      - 'canonicalconnect.com'
      - 'cozy.yachts'
      - 's3.tebi.io'
  selection_persistence_chattr:
    Image|endswith: '/chattr'
    CommandLine|contains|all:
      - '+i' # Detects the attacker making cron files immutable to prevent removal.
      - - '/etc/crontab'
        - '/etc/cron.hourly/logrotate'
        - '/etc/cron.daily/logrotate'
  selection_hashes:
    - Hashes|contains:
        # Known malicious file hashes from the campaign.
        - 'sha1:a923de9df0766d6c4be46191117b8cc6486cf19c'
        - 'sha1:1879d5fa0c2ca816fcb261e96338e325e76dca09'
        - 'sha1:18d83ba336ca6926ce8b9d68f104cff053f0c2f9'
        - 'sha1:815bc1a79440cdc4a7e1d876ff2dc7bc4f53d25e'
        - 'sha1:0851a95d46f035c7759782299422bcfd794e2aec'
        - 'sha1:7074d674d120d19aa7e44e29dd126af152ccdb7c'
        - 'sha1:2d4a23e861ef41df6953195fa4cda115e37a7218'
        - 'sha1:baf0a3b92225f56499c6879b176a3d6163b9d3ef'
        - 'sha1:ea7c97294f415dc8713ac8c280b3123da62f6e56'
  selection_network_iocs:
    - DestinationIp:
        # Detects network connections to known malicious C2, payload, or mining pool IPs.
        - '176.65.148.239'
        - '176.65.148.57'
        - '176.65.148.86'
        - '185.196.8.123'
        - '185.196.8.41'
        - '185.196.8.86'
        - '185.208.156.247'
    - DestinationDomain:
        - 'awarmcorner.world'
        - 'aheatcorner.world'
        - 'canonicalconnect.com'
        - 'cozy.yachts'
        - 's3.tebi.io'
  condition: 1 of them
falsepositives:
  - Legitimate use of a binary named 'logrotate' in a user's home directory is
    highly unlikely. The use of 'chattr +i' on system cron files is also a
    strong indicator of malicious intent. Network connections to the listed IOCs
    are a high-fidelity indicator of compromise.
level: high

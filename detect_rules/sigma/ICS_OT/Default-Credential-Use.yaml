title: Default or Shared Administrator Credential Usage
status: experimental
description: >-
  Detects a single administrative account logging into an unusually high number of distinct hosts.
  This behavior can indicate the use of a compromised shared credential for lateral movement or the
  widespread use of a default administrator account (e.g., an account with SID ending in -500).
references:
author: RW
date: 2025-08-18
tags:
  - attack.initial_access
  - attack.lateral_movement
  - attack.t1078.002
logsource:
  product: windows
  category: logon
detection:
  # This selection identifies successful administrative logons.
  selection:
    EventID: 4624
    LogonType:
      - 2  # Interactive
      - 3  # Network
      - 10 # RemoteInteractive
    # TokenElevationType indicates if the user has admin rights.
    # %%1936 = Full token with no UAC elevation.
    # %%1937 = Elevated token.
    TokenElevationType:
      - '%%1936'
      - '%%1937'
  # This filter excludes common system and machine accounts to reduce noise.
  filter:
    TargetUserName|endswith: '$'
    TargetUserName:
      - 'SYSTEM'
      - 'LOCAL SERVICE'
      - 'NETWORK SERVICE'
      - 'DWM-1'
      - 'UMFD-1'
  # This condition aggregates administrative logons and triggers if a single account
  # is used to access more than 10 distinct computers within one hour.
  condition: selection and not filter | count(distinct Computer) by TargetUserName > 10
  timeframe: 1h
falsepositives:
  - Legitimate administrative tools (e.g., for software deployment, patching, vulnerability scanning) may trigger this detection. The threshold for `count(distinct Computer)` may need to be tuned for your environment.
  - Consider excluding known administrative or service accounts if they generate noise.
level: medium

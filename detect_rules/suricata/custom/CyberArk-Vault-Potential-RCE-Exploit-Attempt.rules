alert http any any -> any any (msg:"Vault Fault: Suspicious IAM GetCallerIdentity Request"; \
flow:to_server; http.method; content:"POST"; http.uri; content:"/sts/GetCallerIdentity"; \
content:"Action=GetCallerIdentity"; http.request_body; content:"Version=2011-06-15"; classtype:attempted-admin; sid:9292001; rev:1;)

alert http any any -> any any (msg:"Vault Fault: CyberArk Host Factory Endpoint Abuse"; \
flow:to_server; http.method; content:"POST"; http.uri; content:"/PasswordVault/api/HostFactory"; \
pcre:"/CreateHost|ModifyHost/i"; http.request_body; content:"policy"; classtype:attempted-admin; sid:9292002; rev:1;)

alert http any any -> any any (msg:"Vault Fault: CyberArk ERB Payload Injection"; \
flow:to_server; http.method; content:"POST"; http.uri; content:"/PasswordVault/api/PolicyFactory"; \
pcre:"/<%.*%>/"; http.request_body; content:"erb"; classtype:attempted-recon; sid:9292003; rev:1;)

alert http any any -> any any (msg:"Vault Fault: HashiCorp Vault Plugin Catalog Abuse"; \
flow:to_server; http.method; content:"PUT"; http.uri; content:"/v1/sys/plugins/catalog"; \
http.request_body; content:"command"; content:"sha256"; classtype:attempted-admin; sid:9292004; rev:1;)

alert http any any -> any any (msg:"Vault Fault: HashiCorp Vault Policy Normalization Abuse"; \
flow:to_server; http.method; content:"POST"; http.uri; content:"/v1/sys/policies/acl"; http.request_body; \
content:"policy"; pcre:"/admin|root/i"; classtype:attempted-admin; sid:9292005; rev:1;)

alert http any any -> any any (msg:"Vault Fault: Certificate Entity Impersonation"; \
flow:to_server; http.method; content:"POST"; http.uri; content:"/v1/auth/cert/login"; \
http.request_body; content:"certificate"; pcre:"/-----BEGIN CERTIFICATE-----.*-----END CERTIFICATE-----/"; \
classtype:attempted-user; sid:9292006; rev:1;)

alert http any any -> any any (msg:"Vault Fault: HashiCorp Vault Lockout Timing Attack"; \
flow:to_server; http.method; content:"POST"; http.uri; content:"/v1/auth/ldap/login"; http.request_body; \
content:"username"; pcre:"/^[A-Za-z]+$/"; threshold:type threshold, track by_src, count 10, seconds 60; \
classtype:attempted-recon; sid:9292007; rev:1;)

alert http any any -> any any (msg:"Vault Fault: HashiCorp Vault Unauthorized Control Group Request"; \
flow:to_server; http.method; content:"POST"; http.uri; content:"/v1/sys/control-group"; http.request_body; \
content:"accessor"; classtype:attempted-admin; sid:9292008; rev:1;)

alert http any any -> any any (msg:"Vault Fault: HashiCorp Vault Barrier Unseal Keys Deletion Attempt"; \
flow:to_server; http.method; content:"DELETE"; http.uri; content:"/v1/core/hsm/_barrier-unseal-keys"; \
classtype:attempted-admin; sid:9292009; rev:1;)

alert http any any -> any any (msg:"Vault Fault: HashiCorp Vault MFA Bypass Attempt"; \
flow:to_server; http.method; content:"POST"; http.uri; content:"/v1/auth/ldap/login"; \
http.request_body; content:"username_as_alias=true"; content:"mfa"; classtype:attempted-user; sid:9292010; rev:1;)
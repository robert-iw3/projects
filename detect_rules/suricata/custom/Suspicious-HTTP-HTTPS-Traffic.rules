alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"Suspicious HTTP/HTTPS Traffic - CSS Accept Header with Non-CSS Resource"; \
flow:established,to_server; http.accept; content:"text/css,*/*;q=0.1"; http.uri; \
content:".ttf|.woff|.woff2|.eot|.bin|.dat|.dll|.exe|.zip|.ps1"; nocase; classtype:suspicious-traffic; sid:1000004; rev:1; \
metadata:author RW, created_at 2025-08-02, description "Detects HTTP/HTTPS requests with a CSS Accept header requesting non-CSS files \
(e.g., fonts, binaries), potentially indicating C2 masquerading as legitimate web traffic", tags T1071.001,T1090.003, severity Medium, \
false_positives "Some web applications or frameworks may use unusual header combinations, review initiating process and URL/IP";)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"Suspicious HTTP/HTTPS Traffic - Connection to Newly Registered Domain"; \
flow:established,to_server; http.host; luajit:nrd_lookup.lua; classtype:suspicious-traffic; sid:1000005; rev:1; \
metadata:author RW, created_at 2025-08-02, description "Detects HTTP/HTTPS connections to newly registered domains (NRDs), \
potentially indicating C2 activity", tags T1071.001,T1090.003, severity Medium, false_positives "Legitimate newly-created domains \
may trigger alerts, review initiating process and URL/IP";)
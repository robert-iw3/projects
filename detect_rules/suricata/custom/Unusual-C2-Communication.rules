alert tls any any -> any 443 (msg:"Unusual SSL C2 Communication - Self-Signed Certificate on Port 443"; \
  flow:established,to_server; \
  tls.cert_issuer; content:"C="; content:"O="; content:"CN="; \
  tls.cert_subject; content:"C="; content:"O="; content:"CN="; \
  tls.cert_issuer; tls.cert_subject; same; \
  classtype:bad-unknown; \
  sid:9999003; \
  rev:1; \
  metadata:tactic TA0011, technique T1071.001, technique T1090, created_by RW, created_at 2025-07-27;)
alert http any any -> any !80,!8080,!8000,!8888 (msg:"Unusual HTTP C2 Communication - HTTP on Non-Standard Port"; \
  flow:established,to_server; \
  http.method; content:"GET"; content:"POST"; bsize:0; \
  classtype:bad-unknown; \
  sid:9999004; \
  rev:1; \
  metadata:tactic TA0011, technique T1071.001, technique T1090, created_by RW, created_at 2025-07-27;)
### Apache Tomcat and Camel Vulnerabilities Report
---

This report details critical remote code execution (RCE) vulnerabilities in Apache Tomcat (CVE-2025-24813) and Apache Camel (CVE-2025-27636, CVE-2025-29891). These flaws allow attackers to execute arbitrary code through specially crafted HTTP requests, posing a significant risk to affected systems.


Recent intelligence indicates widespread exploitation of CVE-2025-24813 in the wild, with scans and exploit attempts surging immediately after public disclosure and the release of proof-of-concept (PoC) exploits. This rapid adoption by attackers, including the use of readily available tools like Nuclei Scanner, highlights the critical need for immediate patching and mitigation.

### Actionable Threat Data
---

CVE-2025-24813 (Apache Tomcat) Exploitation:

Initial HTTP PUT requests for CVE-2025-24813 exploitation often include a `Content-Range` header and a URI ending in `.session` (e.g., `PUT /[filename].session HTTP/1.1`).

The subsequent trigger for CVE-2025-24813 involves an `HTTP GET` request with a Cookie header containing `JSESSIONID=.[filename]`, `where [filename]` matches the staged session file.

Common session name prefixes observed in exploit attempts for CVE-2025-24813 are six characters long, often correlating with a `Content-Range: bytes 0-452/457 header`.

Successful exploitation of CVE-2025-24813 can lead to the vulnerable server attempting to contact an Out-of-Band Application Security Testing (OAST) server.

CVE-2025-27636 and CVE-2025-29891 (Apache Camel) Exploitation:

Exploitation attempts for CVE-2025-27636 and CVE-2025-29891 involve `HTTP requests` with case-modified Camel-specific headers such as `CAmelHttpResponseCode`, `CAmelExecCommandExecutable`, `CAmelExecCommandArgs`, and `CAmelBeanMethodName`.

### Tomcat Partial PUT Exploit - Stage
---
```sql
#
# Name: Apache Tomcat Partial PUT RCE Staging Attempt (CVE-2025-24813)
#
# Date: 2025-07-23
#
# References:
# - https://unit42.paloaltonetworks.com/apache-cve-2025-24813-cve-2025-27636-cve-2025-29891/
#
# Description:
# This detection identifies the initial staging phase of the Apache Tomcat remote code execution vulnerability CVE-2025-24813.
# Attackers send a specially crafted HTTP PUT request with a URI ending in ".session" and a "Content-Range" header
# to upload a serialized malicious payload to a vulnerable server. This is the first of a two-step attack.
#
# Data Source:
# This rule requires web server, proxy, or network traffic logs that include HTTP method, URI, and full HTTP headers.
# Ensure your data is mapped to the Splunk Common Information Model (CIM), specifically the Web data model.
#
# False Positive Sensitivity: Medium
#
# False positives may occur if a legitimate application uses partial PUT requests to upload session files, though this is highly unconventional.
# Consider filtering by destination port (e.g., 80, 443, 8080, 8443) if your data source includes it.
# You may also need to add specific applications or source IPs to an allowlist if they are known to exhibit this behavior for legitimate reasons.
#
# Recommended Next Steps:
# - Investigate the source IP to determine if it is a known scanner or a malicious actor.
# - Examine the destination server to confirm if it is running a vulnerable version of Apache Tomcat.
# - Look for the follow-up trigger request (an HTTP GET with a "JSESSIONID=.[filename]" cookie) from the same source IP.
# - If the activity is confirmed malicious, isolate the compromised host and review for further signs of compromise.
#
(index=web OR sourcetype=pan:traffic OR sourcetype=stream:http OR sourcetype=opensecurity:http)
# Filter for HTTP PUT requests, which are used to upload the malicious file.
http_method="PUT"
# The exploit targets URIs ending in .session to stage the payload as a session file.
uri_path="*.session"
# The vulnerability is triggered by the presence of the Content-Range header, indicating a partial file write.
http_header="*Content-Range:*"
# Aggregate events to reduce noise and summarize activity.
| stats count min(_time) as firstTime max(_time) as lastTime by src, dest, http_user_agent, uri_path, http_header
| rename src as src_ip, dest as dest_ip, http_user_agent as user_agent
# Provide useful context for investigation.
| fields firstTime, lastTime, src_ip, dest_ip, user_agent, uri_path, http_header, count
| `security_content_ctime(firstTime)`
| `security_content_ctime(lastTime)`
```

### Tomcat Partial PUT Exploit - Trigger
---
```sql
#
# Name: Apache Tomcat Partial PUT RCE Trigger (CVE-2025-24813)
#
# Date: 2025-07-23
#
# References:
# - https://unit42.paloaltonetworks.com/apache-cve-2025-24813-cve-2025-27636-cve-2025-29891/
#
# Description:
# This detection identifies the second/trigger phase of the Apache Tomcat remote code execution vulnerability CVE-2025-24813.
# After staging a malicious payload, attackers send an HTTP GET request with a specially crafted "JSESSIONID" cookie
# that starts with a period (e.g., "JSESSIONID=.filename"). This causes Tomcat to load and deserialize the malicious session file, leading to RCE.
#
# Data Source:
# This rule requires web server, proxy, or network traffic logs that include HTTP method and full cookie information.
# Ensure your data is mapped to the Splunk Common Information Model (CIM), specifically the Web data model.
#
# False Positive Sensitivity: Medium
#
# False positives are unlikely as legitimate JSESSIONID values should not begin with a period. However, non-standard applications might
# use a similar cookie format. If false positives occur, consider adding specific applications or source IPs to an allowlist.
#
# Recommended Next Steps:
# - Investigate the source IP for other suspicious activity.
# - Correlate this trigger event with a preceding staging event (HTTP PUT to a ".session" file with a "Content-Range" header) from the same source IP.
# - Examine the destination server for the malicious session file (e.g., in $TOMCAT_HOME/work/Catalina/localhost/ROOT/) and other signs of compromise.
# - If the activity is confirmed malicious, isolate the host and begin incident response procedures.
#
(index=web OR sourcetype=pan:traffic OR sourcetype=stream:http OR sourcetype=opensecurity:http)
# Filter for HTTP GET requests, which are used to trigger the exploit.
http_method="GET"
# The exploit trigger uses a JSESSIONID cookie value that starts with a literal period.
cookie="*JSESSIONID=.*"
# Aggregate events to reduce noise and summarize activity.
| stats count min(_time) as firstTime max(_time) as lastTime by src, dest, http_user_agent, url, cookie
| rename src as src_ip, dest as dest_ip, http_user_agent as user_agent
# Provide useful context for investigation.
| fields firstTime, lastTime, src_ip, dest_ip, user_agent, url, cookie, count
| `security_content_ctime(firstTime)`
| `security_content_ctime(lastTime)`
```

### Apache Camel RCE via Header Bypass
---
```sql
#
# Name: Apache Camel RCE via Header Bypass (CVE-2025-27636, CVE-2025-29891)
#
# Date: 2025-07-23
#
# References:
# - https://unit42.paloaltonetworks.com/apache-cve-2025-24813-cve-2025-27636-cve-2025-29891/
#
# Description:
# This detection identifies attempts to exploit remote code execution vulnerabilities CVE-2025-27636 and CVE-2025-29891 in Apache Camel.
# Attackers can bypass a case-sensitive header filter by sending HTTP requests with specially crafted headers (e.g., starting with "CAmel" instead of "Camel").
# This can lead to the execution of arbitrary commands on the vulnerable server.
#
# Data Source:
# This rule requires web server, proxy, or network traffic logs that include full HTTP header information.
# Ensure your data is mapped to the Splunk Common Information Model (CIM), specifically the Web data model.
#
# False Positive Sensitivity: Medium
#
# False positives are unlikely as legitimate Camel headers should not use the "CAmel" case variation. However, non-standard or custom applications
# might inadvertently use this pattern. If false positives occur, consider adding specific applications or source IPs to an allowlist.
#
# Recommended Next Steps:
# - Investigate the source IP for other suspicious activity.
# - Examine the destination server to confirm if it is running a vulnerable version of Apache Camel and look for signs of compromise (e.g., unexpected processes, reverse shells).
# - Review the full http_header field in the alert to understand the attempted command or action.
# - If the activity is confirmed malicious, isolate the host and begin incident response procedures.
#
(index=web OR sourcetype=pan:traffic OR sourcetype=stream:http OR sourcetype=opensecurity:http)
# Filter for HTTP requests containing the specific case-bypassing Camel headers.
(http_header="*CAmelHttpResponseCode*" OR http_header="*CAmelExecCommandExecutable*" OR http_header="*CAmelExecCommandArgs*" OR http_header="*CAmelBeanMethodName*")
# Aggregate events to summarize activity and reduce noise.
| stats count min(_time) as firstTime max(_time) as lastTime by src, dest, http_user_agent, url, http_header
| rename src as src_ip, dest as dest_ip, http_user_agent as user_agent
# Provide useful context for investigation.
| fields firstTime, lastTime, src_ip, dest_ip, user_agent, url, http_header, count
| `security_content_ctime(firstTime)`
| `security_content_ctime(lastTime)`
```

### OAST Server Contact from Tomcat
---
```sql
#
# Name: Outbound Connection to OAST Domain
#
# Date: 2025-07-23
#
# References:
# - https://unit42.paloaltonetworks.com/apache-cve-2025-24813-cve-2025-27636-cve-2025-29891/
#
# Description:
# This detection identifies outbound network connections from an internal host to a known Out-of-Band Application Security Testing (OAST) domain.
# OAST services are often used by attackers to confirm successful exploitation of vulnerabilities that do not provide a direct response,
# such as blind SQL injection or blind remote code execution. Successful exploitation of CVE-2025-24813 on Apache Tomcat, for example,
# can result in the compromised server making a callback to an OAST server.
#
# Data Source:
# This rule requires network traffic logs such as firewall, proxy, or DNS logs.
# Ensure your data is mapped to the Splunk Common Information Model (CIM) or uses common field names like src, dest, url, and query.
#
# False Positive Sensitivity: Medium
#
# This activity can be generated by legitimate security scanning tools or penetration testing activities.
# If your organization conducts authorized security testing, consider adding the IP addresses of scanners or testers to an allowlist to reduce false positives.
#
# Recommended Next Steps:
# - Investigate the source host (src_ip) to determine its role and owner.
# - Check if the source host is an Apache Tomcat server or another public-facing web application.
# - Correlate this activity with inbound traffic logs to look for signs of a preceding exploit attempt against the source host.
# - If the activity is confirmed malicious, isolate the host and begin incident response procedures.
#
(index=pan* OR index=proxy* OR index=dns* OR sourcetype=pan:traffic OR sourcetype=stream:http OR sourcetype=stream:dns)
# Check multiple common fields for a list of known OAST and canary token domains.
(
    dest="*oast.me" OR dest="*oast.pro" OR dest="*oast.live" OR dest="*oast.site" OR dest="*oast.online" OR dest="*oast.fun" OR dest="*oast.host" OR dest="*oast.cloud" OR dest="*interact.sh" OR dest="*burpcollaborator.net" OR dest="*requestbin.net" OR dest="*canarytokens.com" OR
    url="*oast.me*" OR url="*oast.pro*" OR url="*oast.live*" OR url="*oast.site*" OR url="*oast.online*" OR url="*oast.fun*" OR url="*oast.host*" OR url="*oast.cloud*" OR url="*interact.sh*" OR url="*burpcollaborator.net*" OR url="*requestbin.net*" OR url="*canarytokens.com*" OR
    query="*oast.me" OR query="*oast.pro" OR query="*oast.live" OR query="*oast.site" OR query="*oast.online" OR query="*oast.fun" OR query="*oast.host" OR query="*oast.cloud" OR query="*interact.sh" OR query="*burpcollaborator.net" OR query="*requestbin.net" OR query="*canarytokens.com"
)
# Normalize the field containing the OAST domain for consistent reporting.
| eval contacted_domain=coalesce(query, url, dest)
# Aggregate results by the source IP to reduce alert volume.
| stats count min(_time) as firstTime max(_time) as lastTime values(contacted_domain) as contacted_domains by src
| rename src as src_ip
# Provide useful context for investigation.
| fields firstTime, lastTime, src_ip, contacted_domains, count
| `security_content_ctime(firstTime)`
| `security_content_ctime(lastTime)`
```

### CVE-2025-24813 Exploit Source IPs
---
```sql
#
# Name: CVE-2025-24813 Exploit Attempt from Known Malicious IP
#
# Date: 2025-07-23
#
# References:
# - https://unit42.paloaltonetworks.com/apache-cve-2025-24813-cve-2025-27636-cve-2025-29891/
#
# Description:
# This detection identifies network traffic originating from IP addresses that have been observed in the wild attempting to exploit the Apache Tomcat RCE vulnerability, CVE-2025-24813.
#
# Data Source:
# This rule requires network traffic logs (e.g., firewall, netflow, Zeek) mapped to the Splunk Common Information Model (CIM), specifically the Network_Traffic data model.
#
# False Positive Sensitivity: Medium
#
# IP addresses can be dynamic or part of shared infrastructure (e.g., NAT, VPNs, cloud providers). An alert may not indicate a direct attack if the IP has been reassigned.
# It is important to correlate this activity with other detection rules for CVE-2025-24813 (staging and trigger patterns) to confirm a targeted attack.
#
# Recommended Next Steps:
# - Investigate the destination host (dest_ip) to determine if it is an Apache Tomcat server.
# - Correlate the traffic with web server logs on the destination host to look for exploit patterns associated with CVE-2025-24813.
# - If the activity is deemed malicious, consider blocking the source IP address at the network perimeter.
#
`tstats` count min(_time) as firstTime max(_time) as lastTime from datamodel=Network_Traffic where
# Search for traffic from known malicious source IPs.
All_Traffic.src IN ("54.193.62.84", "96.113.95.10", "209.189.232.134", "162.241.149.101", "167.172.67.75", "100.65.135.245", "138.197.82.147", "123.16.159.102", "193.53.40.18", "91.208.206.203", "212.56.34.85", "195.164.49.70", "185.91.127.9")
# Group results to summarize connections from a malicious IP to an internal destination.
by All_Traffic.src, All_Traffic.dest, All_Traffic.dest_port
| rename "All_Traffic.*" as *
# Provide useful context for investigation.
| `security_content_ctime(firstTime)`
| `security_content_ctime(lastTime)`
| fields firstTime, lastTime, src, dest, dest_port, count
```

### CVE-2025-27636/29891 Exploit Source IPs
---
```sql
#
# Name: CVE-2025-27636/29891 Exploit Attempt from Known Malicious IP
#
# Date: 2025-07-23
#
# References:
# - https://unit42.paloaltonetworks.com/apache-cve-2025-24813-cve-2025-27636-cve-2025-29891/
#
# Description:
# This detection identifies network traffic originating from IP addresses that have been observed in the wild attempting to exploit the Apache Camel RCE vulnerabilities, CVE-2025-27636 and CVE-2025-29891.
#
# Data Source:
# This rule requires network traffic logs (e.g., firewall, netflow, Zeek) mapped to the Splunk Common Information Model (CIM), specifically the Network_Traffic data model.
#
# False Positive Sensitivity: Medium
#
# IP addresses can be dynamic or part of shared infrastructure (e.g., NAT, VPNs, cloud providers). An alert may not indicate a direct attack if the IP has been reassigned.
# It is important to correlate this activity with other detection rules for CVE-2025-27636/29891 (e.g., looking for case-bypassed Camel headers) to confirm a targeted attack.
#
# Recommended Next Steps:
# - Investigate the destination host (dest_ip) to determine if it is an Apache Camel server.
# - Correlate the traffic with web server logs on the destination host to look for exploit patterns associated with CVE-2025-27636/29891.
# - If the activity is deemed malicious, consider blocking the source IP address at the network perimeter.
#
`tstats` count min(_time) as firstTime max(_time) as lastTime from datamodel=Network_Traffic where
# Search for traffic from known malicious source IPs.
All_Traffic.src IN ("30.153.178.49", "54.147.173.17", "54.120.8.214", "139.87.112.169", "139.87.112.115", "64.39.98.52", "139.87.112.98", "139.87.113.24", "64.39.98.139", "54.96.66.57", "138.197.82.147", "22.85.196.34", "64.39.98.245", "64.39.98.9", "54.120.8.207", "130.212.99.156", "139.87.112.121", "139.87.113.26")
# Group results to summarize connections from a malicious IP to an internal destination.
by All_Traffic.src, All_Traffic.dest, All_Traffic.dest_port
| rename "All_Traffic.*" as *
# Provide useful context for investigation.
| `security_content_ctime(firstTime)`
| `security_content_ctime(lastTime)`
| fields firstTime, lastTime, src, dest, dest_port, count
```

### CVE-2025-24813 Payload Hashes
---
```sql
#
# Name: Known CVE-2025-24813 Payload Hash
#
# Date: 2025-07-23
#
# References:
# - https://unit42.paloaltonetworks.com/apache-cve-2025-24813-cve-2025-27636-cve-2025-29891/
#
# Description:
# This detection identifies the presence of files on an endpoint that match known SHA256 hashes of payloads used in CVE-2025-24813 exploit attempts.
# The presence of such a file indicates that a system may have been targeted or compromised.
#
# Data Source:
# This rule requires endpoint data (e.g., Sysmon, EDR logs) mapped to the Splunk Common Information Model (CIM), specifically the Endpoint.Filesystem data model.
#
# False Positive Sensitivity: Medium
#
# While file hashes are highly specific, a false positive could occur if a security tool quarantines the file and logs the hash.
# This would be a true positive for the presence of the hash, but not necessarily an active compromise.
#
# Recommended Next Steps:
# - Investigate the host (dest) to determine the file's origin and execution status.
# - Correlate this finding with network logs to identify any related exploit attempts (e.g., PUT requests to .session files).
# - If the file was executed, assume the host is compromised and initiate incident response procedures.
#
`tstats` summariesonly=true count min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Filesystem where
# Search for known malicious file hashes associated with CVE-2025-24813.
Filesystem.file_hash IN ("6a9a0a3f0763a359737da801a48c7a0a7a75d6fa810418216628891893773540", "6b7912e550c66688c65f8cf8651b638defc4dbeabae5f0f6a23fb20d98333f6b")
# Group by host and file details to identify where the malicious file was seen.
by Filesystem.dest, Filesystem.file_path, Filesystem.file_name, Filesystem.file_hash
| rename "Filesystem.*" as *
# Provide useful context for investigation.
| `security_content_ctime(firstTime)`
| `security_content_ctime(lastTime)`
| fields firstTime, lastTime, dest, file_path, file_name, file_hash, count
```

### Linux Kernel Vulnerability: CVE-2025-37752 in SFQ Qdisc
---

CVE-2025-37752 is an out-of-bounds write vulnerability in the Linux kernel's network packet scheduler, specifically within the Stochastic Fairness Queueing (SFQ) discipline. This flaw, when exploited, can lead to privilege escalation due to a 0x0000 being written approximately 256KB out-of-bounds, enabling a page-level Use-After-Free (UAF) and arbitrary read/write primitives.

The article details a novel exploitation technique for CVE-2025-37752 that achieves a page-level UAF and arbitrary read/write by corrupting the pipe->files field of a named pipe, a significant advancement beyond a simple denial-of-service. This method involves carefully manipulating kernel memory allocation to place victim objects (named pipes) at predictable offsets relative to the vulnerable SFQ Qdisc objects, allowing for a targeted out-of-bounds write to achieve privilege escalation.

### Actionable Threat Data
---

Vulnerable Component Identification: The vulnerability resides in the SFQ queuing discipline (`CONFIG_NET_SCH_SFQ`) when used in conjunction with the Token Bucket Filter (TBF) Qdisc. Systems with `CONFIG_USER_NS` enabled are also affected.

Exploitation Trigger: The vulnerability is triggered by a specific interaction between SFQ and TBF Qdiscs where the SFQ limit is indirectly set to one, leading to an underflow in `sfq_dec()` and a type confusion between `sk_buff` and `sfq_slot`.

Memory Corruption Pattern: The exploit involves a `0x0000` write approximately `262636 bytes (0x401EC)` out-of-bounds from the vulnerable `SFQ Qdisc object`. This write targets `pipe_inode_info` objects, specifically the pipe->files field, which is allocated in `kmalloc-cg-192`.

Exploitation Primitives: Successful exploitation leads to a page-level Use-After-Free (UAF) on a `pipe->tmp_page`, which can then be reclaimed with `signalfd` files to achieve arbitrary read/write by swapping `file->private_data` with `file->f_cred`.

Mitigation Bypass: The exploit stabilizes the kernel by spraying `sfq_slots` in `kmalloc-64` to prevent crashes in `qdisc_bstats_update()` and reconfiguring the TBF Qdisc (dropping rate via `TCA_TBF_RATE64` and adding packet overhead) to prevent the type-confused skb from being dequeued.

### Potential CVE-2025-37752 Exploitation via SFQ Qdisc Configuration
---
```sql
| from datamodel=Endpoint.Processes
| where process_name=\"tc\"
| where (process LIKE \"%qdisc%\" AND process LIKE \"%sfq%\" AND process LIKE \"%limit 1%\" AND process LIKE \"%depth 1%\")
| stats count min(_time) as firstTime max(_time) as lastTime by dest, user, process, process_id, parent_process
| `security_content_ctime(firstTime)`
| `security_content_ctime(lastTime)`
```

### Potential CVE-2025-37752 Exploitation - Pipe Descriptor Manipulation
---
```sql
| from datamodel=Endpoint.Filesystem

// Filter for file access events targeting the /proc/self/fd/ directory.
| where file_path LIKE \"/proc/self/fd/%\"

// Group events into 5-minute windows to analyze activity bursts.
| bin span=5m _time

// Count the number of unique file descriptors accessed by each process.
| stats dc(file_path) as distinct_fd_count by _time, dest, user, process_name, process_id

// The exploit opens a large number of pipes to groom memory. Alert on a high count.
// This threshold may need tuning for your environment.
| where distinct_fd_count > 100

// Format timestamps for readability.
| `security_content_ctime(firstTime)`
| `security_content_ctime(lastTime)`"
```

### Potential CVE-2025-37752 Exploitation - Signalfd Reclamation
---
```sql
| from datamodel=Endpoint.Filesystem

// The exploit uses signalfd to reclaim a freed page, creating a file object represented as \"[signalfd]\".
| where file_name=\"[signalfd]\"

// Group events in a short time window to detect heap spraying behavior.
| bin span=1m _time

// Count the number of signalfd files created by a single process.
| stats count by _time, dest, user, process_name, process_id, parent_process_name

// Alert if a process creates an unusually high number of signalfd files.
// This threshold may need tuning based on normal application behavior.
| where count > 10

// Format timestamps for readability.
| `security_content_ctime(firstTime)`
| `security_content_ctime(lastTime)`
```
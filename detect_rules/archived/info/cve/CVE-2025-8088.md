### RomCom Exploits WinRAR Zero-Day Vulnerability (CVE-2025-8088)
---

The Russia-aligned RomCom threat group is actively exploiting a WinRAR zero-day vulnerability (CVE-2025-8088) via spearphishing campaigns, delivering various backdoors like SnipBot, RustyClaw, and Mythic agent. This vulnerability, a path traversal flaw using alternate data streams, allows malicious files to be silently deployed upon archive extraction, leading to persistence and further compromise.

RomCom's continued reliance on zero-day exploits, with CVE-2025-8088 being their third observed in the wild, highlights their significant investment in acquiring and utilizing novel vulnerabilities for targeted attacks. The use of alternate data streams (ADS) for path traversal in this WinRAR exploit is a noteworthy technique for evading detection and silently deploying malicious payloads.

### Actionable Threat Data
---

Monitor for the creation of LNK files in the Windows startup directory (%APPDATA%\Microsoft\Windows\Start Menu\Programs\Startup) that are dropped from RAR archives, as this is a common persistence mechanism used in these attacks.

Detect attempts to hijack COM objects by monitoring for modifications to HKCU\SOFTWARE\Classes\CLSID\{1299CF18-C4F5-4B6A-BB0F-2299F0398E27}\InprocServer32 or similar CLSIDs, especially when associated with processes like msedge.exe.

Look for the execution of suspicious executables or DLLs from temporary directories (%TEMP% or %LOCALAPPDATA%) that are dropped from RAR archives and exhibit anti-analysis techniques such as checking for a specific number of recently opened documents or hardcoded domain names.

Identify network connections to known RomCom C2 infrastructure, including srlaptop[.]com, campanole[.]com, melamorri[.]com, and gohazeldale[.]com.

Monitor for the execution of wmic.exe as a child process of suspicious executables, as this has been observed in the Mythic agent execution chain.

### Splunk
---
```sql
-- MITRE TTPs: T1204.002, T1566.001, T1546.015, T1059, T1497, T1071.001, T1047
-- Note: This query relies on the Splunk Common Information Model (CIM), specifically the Endpoint data model.

-- Detection 1: WinRAR Path Traversal (CVE-2025-8088)
`tstats` summariesonly=true count from datamodel=Endpoint.Filesystem where Filesystem.process_name="winrar.exe" AND ((Filesystem.file_path="*\\Microsoft\\Windows\\Start Menu\\Programs\\Startup*" AND Filesystem.file_name="*.lnk") OR (Filesystem.file_path="*\\AppData\\Local\\*" AND (Filesystem.file_name="*.exe" OR Filesystem.file_name="*.dll"))) by _time, Filesystem.dest, Filesystem.process_guid, Filesystem.process, Filesystem.file_path, Filesystem.file_name
| `comment("Correlate LNK creation in Startup with payload drop in temp location within a 2-minute window.")`
| bin _time span=2m
| stats values(Filesystem.process) as InitiatingProcessCommandLine, count(eval(if(match(Filesystem.file_path, "Startup") AND match(Filesystem.file_name, "\.lnk$"), 1, NULL))) as LnkInStartup, count(eval(if(match(Filesystem.file_path, "AppData\\\\Local"), 1, NULL))) as PayloadInTemp, values(eval(Filesystem.file_path."\\\\".Filesystem.file_name)) as FileName by _time, dest, process_guid
| where LnkInStartup > 0 AND PayloadInTemp > 0
| `comment("Format results to a common schema")`
| rename dest as DeviceName
| eval DetectionName="WinRAR Path Traversal (CVE-2025-8088)", Description="WinRAR created LNK in startup and payload in temp. Files: ".mvjoin(FileName, ", "), InitiatingProcessFileName="winrar.exe", ProcessCommandLine="", RegistryKey="", RemoteUrl=""
| fields _time, DeviceName, DetectionName, Description, InitiatingProcessFileName, InitiatingProcessCommandLine, FileName, ProcessCommandLine, RegistryKey, RemoteUrl

-- Detection 2: RomCom COM Hijacking for Persistence
| append [
    `tstats` summariesonly=true values(Registry.registry_value_data) as RegistryValueData from datamodel=Endpoint.Registry where Registry.action IN ("created", "modified") AND Registry.registry_path="*CLSID\\{1299CF18-C4F5-4B6A-BB0F-2299F0398E27}\\InprocServer32*" AND Registry.registry_value_data="*\\AppData\\Local\\Temp\\*.dll" by _time, Registry.dest, Registry.process_name, Registry.process, Registry.registry_path
    | `comment("Format results to a common schema")`
    | rename Registry.dest as DeviceName, Registry.process_name as InitiatingProcessFileName, Registry.process as InitiatingProcessCommandLine, Registry.registry_path as RegistryKey, RegistryValueData as FileName
    | eval DetectionName="RomCom COM Hijacking", Description="COM Hijacking Detected. Key: ".RegistryKey.", Value: ".FileName, ProcessCommandLine="", RemoteUrl=""
    | fields _time, DeviceName, DetectionName, Description, InitiatingProcessFileName, InitiatingProcessCommandLine, FileName, ProcessCommandLine, RegistryKey, RemoteUrl
]

-- Detection 3: Suspicious Execution from Temp with RecentDocs Anti-Analysis Check
| append [
    `tstats` summariesonly=true count from datamodel=Endpoint where (nodename=Endpoint.Processes (Processes.process_path IN ("*\\AppData\\Local\\Temp\\*", "*\\AppData\\Local\\*") AND Processes.process_name="*.exe")) OR (nodename=Endpoint.Registry Registry.registry_path="*\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\RecentDocs*") by _time, Processes.process_id, Processes.dest, Processes.process_name, Processes.process_path, Processes.process, Processes.parent_process, Registry.registry_path
    | `comment("Correlate process execution and registry access by the same process ID within a 2-minute window.")`
    | bin _time span=2m
    | stats values(Processes.process_name) as FileName, values(Processes.process_path) as FolderPath, values(Processes.process) as ProcessCommandLine, values(Processes.parent_process) as InitiatingProcessCommandLine, values(Registry.registry_path) as RegistryKey by _time, dest, Processes.process_id
    | where isnotnull(FileName) AND isnotnull(RegistryKey)
    | `comment("Format results to a common schema")`
    | rename dest as DeviceName
    | eval InitiatingProcessFileName=mvindex(split(InitiatingProcessCommandLine, " "), 0)
    | eval DetectionName="Suspicious Temp Exec with RecentDocs Check", Description="Process ".FileName." executed from temp and checked RecentDocs registry keys.", RemoteUrl=""
    | fields _time, DeviceName, DetectionName, Description, InitiatingProcessFileName, InitiatingProcessCommandLine, FileName, ProcessCommandLine, RegistryKey, RemoteUrl
]

-- Detection 4: RomCom C2 Domain Activity
| append [
    `tstats` summariesonly=true values(Network_Traffic.url) as RemoteUrl from datamodel=Endpoint.Network_Traffic where (Network_Traffic.url IN ("*srlaptop.com*", "*campanole.com*", "*melamorri.com*", "*gohazeldale.com*")) by _time, Network_Traffic.dest, Network_Traffic.process_name, Network_Traffic.process
    | `comment("Format results to a common schema")`
    | rename Network_Traffic.dest as DeviceName, Network_Traffic.process_name as InitiatingProcessFileName, Network_Traffic.process as InitiatingProcessCommandLine
    | eval DetectionName="RomCom C2 Domain Activity", Description="Network connection to known RomCom C2: ".RemoteUrl, FileName="", ProcessCommandLine="", RegistryKey=""
    | fields _time, DeviceName, DetectionName, Description, InitiatingProcessFileName, InitiatingProcessCommandLine, FileName, ProcessCommandLine, RegistryKey, RemoteUrl
]

-- Detection 5: RomCom Mythic Agent WMIC Execution
| append [
    `tstats` summariesonly=true count from datamodel=Endpoint.Processes where Processes.process_name="wmic.exe" AND Processes.parent_process_name!="svchost.exe" AND (Processes.parent_process_path IN ("*\\AppData\\Local\\Temp\\*", "*\\AppData\\Local\\*", "*\\Users\\Public\\*", "*\\ProgramData\\*", "*C:\\Temp\\*")) by _time, Processes.dest, Processes.process_name, Processes.process, Processes.parent_process_name, Processes.parent_process_path, Processes.parent_process
    | `comment("Format results to a common schema")`
    | rename Processes.dest as DeviceName, Processes.process_name as FileName, Processes.process as ProcessCommandLine, Processes.parent_process_name as InitiatingProcessFileName, Processes.parent_process as InitiatingProcessCommandLine, Processes.parent_process_path as InitiatingProcessFolderPath
    | eval DetectionName="RomCom Mythic Agent WMIC Execution", Description="wmic.exe spawned by suspicious parent: ".InitiatingProcessFileName." in ".InitiatingProcessFolderPath, RegistryKey="", RemoteUrl=""
    | fields _time, DeviceName, DetectionName, Description, InitiatingProcessFileName, InitiatingProcessCommandLine, FileName, ProcessCommandLine, RegistryKey, RemoteUrl
]
```

### Crowdstrike
---
```sql
-- Detection 1: WinRAR Path Traversal (CVE-2025-8088)

event_platform=Win event_simpleName=FileWrite ImageFileName:"\\winrar.exe"
((TargetFileName:/\.lnk$/ AND TargetFileName:/\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\/) OR
 (TargetFileName:/(\.exe|\.dll)$/ AND TargetFileName:/\\AppData\\Local\\/))
| bucket 120s by timestamp, ComputerName, ContextProcessId as process_guid
| group by timestamp, ComputerName, process_guid
| filter sum(case(TargetFileName:/\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\/ AND TargetFileName:/\.lnk$/, 1, else=0)) as LnkInStartup > 0
  AND sum(case(TargetFileName:/\\AppData\\Local\\/, 1, else=0)) as PayloadInTemp > 0
| project timestamp, ComputerName, DetectionName="WinRAR Path Traversal (CVE-2025-8088)",
  Description=strcat("WinRAR created LNK in startup and payload in temp. Files: ", array_join(TargetFileName, ", ")),
  InitiatingProcessFileName="winrar.exe", InitiatingProcessCommandLine=CommandLine, FileName=TargetFileName,
  ProcessCommandLine="", RegistryKey="", RemoteUrl=""

-- Detection 2: RomCom COM Hijacking for Persistence

event_platform=Win event_simpleName=RegistryValueWrite
RegistryKeyName:/CLSID\\{1299CF18-C4F5-4B6A-BB0F-2299F0398E27}\\InprocServer32/
RegistryValue:/\\AppData\\Local\\Temp\\.*\.dll/
| project timestamp, ComputerName, DetectionName="RomCom COM Hijacking",
  Description=strcat("COM Hijacking Detected. Key: ", RegistryKeyName, ", Value: ", RegistryValue),
  InitiatingProcessFileName=ImageFileName, InitiatingProcessCommandLine=CommandLine,
  FileName=RegistryValue, ProcessCommandLine="", RegistryKey=RegistryKeyName, RemoteUrl=""

-- Detection 3: Suspicious Execution from Temp with RecentDocs Anti-Analysis Check

event_platform=Win (event_simpleName IN (ProcessRollup2, SyntheticProcessRollup2)
  (TargetFileName:/\\AppData\\Local\\(Temp\\)?.*\\.exe$/) OR
  (event_simpleName=RegistryValueWrite RegistryKeyName:/\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\RecentDocs/))
| bucket 120s by timestamp, ComputerName, ContextProcessId as process_id
| group by timestamp, ComputerName, process_id
| filter array_length(TargetFileName) > 0 AND array_length(RegistryKeyName) > 0
| project timestamp, ComputerName, DetectionName="Suspicious Temp Exec with RecentDocs Check",
  Description=strcat("Process ", array_join(TargetFileName, ", "), " executed from temp and checked RecentDocs registry keys."),
  InitiatingProcessFileName=ParentBaseFileName, InitiatingProcessCommandLine=ParentCommandLine,
  FileName=TargetFileName, ProcessCommandLine=CommandLine, RegistryKey=RegistryKeyName, RemoteUrl=""

-- Detection 4: RomCom C2 Domain Activity

event_platform=Win event_simpleName=NetworkConnect
TargetUrl IN ("*srlaptop.com*", "*campanole.com*", "*melamorri.com*", "*gohazeldale.com*")
| project timestamp, ComputerName, DetectionName="RomCom C2 Domain Activity",
  Description=strcat("Network connection to known RomCom C2: ", TargetUrl),
  InitiatingProcessFileName=ImageFileName, InitiatingProcessCommandLine=CommandLine,
  FileName="", ProcessCommandLine="", RegistryKey="", RemoteUrl=TargetUrl

-- Detection 5: RomCom Mythic Agent WMIC Execution

event_platform=Win event_simpleName=ProcessRollup2
ImageFileName:"\\wmic.exe" ParentBaseFileName!~"svchost.exe"
ParentImageFileName:/(\\AppData\\Local\\(Temp\\)?|\\Users\\Public\\|\\ProgramData\\|C:\\Temp\\)/
| project timestamp, ComputerName, DetectionName="RomCom Mythic Agent WMIC Execution",
  Description=strcat("wmic.exe spawned by suspicious parent: ", ParentBaseFileName, " in ", ParentImageFileName),
  InitiatingProcessFileName=ParentBaseFileName, InitiatingProcessCommandLine=ParentCommandLine,
  FileName=ImageFileName, ProcessCommandLine=CommandLine, RegistryKey="", RemoteUrl=""
```

### Datadog
---
```sql
-- Detection 1: WinRAR Path Traversal (CVE-2025-8088)

source:edr process_name:winrar.exe
((file_path:*\\Microsoft\\Windows\\Start Menu\\Programs\\Startup* file_name:*.lnk) OR
 (file_path:*\\AppData\\Local\\* (file_name:*.exe OR file_name:*.dll)))
| timeslice 2m
| groupby @timestamp, host, process_guid
| select @timestamp, host, DetectionName="WinRAR Path Traversal (CVE-2025-8088)",
  Description=strcat("WinRAR created LNK in startup and payload in temp. Files: ", array_join(file_path + "\\" + file_name, ", ")),
  InitiatingProcessFileName="winrar.exe", InitiatingProcessCommandLine=command_line,
  FileName=array_join(file_path + "\\" + file_name, ", "), ProcessCommandLine="", RegistryKey="", RemoteUrl=""
| where sum(case(file_path:*Startup* AND file_name:*.lnk, 1, else=0)) as LnkInStartup > 0
  AND sum(case(file_path:*AppData\\Local*, 1, else=0)) as PayloadInTemp > 0

-- Detection 2: RomCom COM Hijacking for Persistence

source:edr registry_key:*CLSID\\{1299CF18-C4F5-4B6A-BB0F-2299F0398E27}\\InprocServer32*
registry_value:*\\AppData\\Local\\Temp\\*.dll
| select @timestamp, host, DetectionName="RomCom COM Hijacking",
  Description=strcat("COM Hijacking Detected. Key: ", registry_key, ", Value: ", registry_value),
  InitiatingProcessFileName=process_name, InitiatingProcessCommandLine=command_line,
  FileName=registry_value, ProcessCommandLine="", RegistryKey=registry_key, RemoteUrl=""

-- Detection 3: Suspicious Execution from Temp with RecentDocs Anti-Analysis Check

source:edr ((process_path:*\\AppData\\Local\\* process_name:*.exe) OR
 registry_key:*\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\RecentDocs*)
| timeslice 2m
| groupby @timestamp, host, process_id
| select @timestamp, host, DetectionName="Suspicious Temp Exec with RecentDocs Check",
  Description=strcat("Process ", array_join(process_name, ", "), " executed from temp and checked RecentDocs registry keys."),
  InitiatingProcessFileName=parent_process_name, InitiatingProcessCommandLine=parent_command_line,
  FileName=array_join(process_name, ", "), ProcessCommandLine=command_line, RegistryKey=array_join(registry_key, ", "), RemoteUrl=""
| where array_length(process_name) > 0 AND array_length(registry_key) > 0

-- Detection 4: RomCom C2 Domain Activity

source:network url:(*srlaptop.com* OR *campanole.com* OR *melamorri.com* OR *gohazeldale.com*)
| select @timestamp, host, DetectionName="RomCom C2 Domain Activity",
  Description=strcat("Network connection to known RomCom C2: ", url),
  InitiatingProcessFileName=process_name, InitiatingProcessCommandLine=command_line,
  FileName="", ProcessCommandLine="", RegistryKey="", RemoteUrl=url

-- Detection 5: RomCom Mythic Agent WMIC Execution

source:edr process_name:wmic.exe parent_process_name:-svchost.exe
parent_process_path:(*\\AppData\\Local\\* OR *\\Users\\Public\\* OR *\\ProgramData\\* OR *C:\\Temp\\*)
| select @timestamp, host, DetectionName="RomCom Mythic Agent WMIC Execution",
  Description=strcat("wmic.exe spawned by suspicious parent: ", parent_process_name, " in ", parent_process_path),
  InitiatingProcessFileName=parent_process_name, InitiatingProcessCommandLine=parent_command_line,
  FileName=process_name, ProcessCommandLine=command_line, RegistryKey="", RemoteUrl=""
```

### Elastic
---
```sql
-- Detection 1: WinRAR Path Traversal (CVE-2025-8088)

FROM * -- <-- edr index or data-stream
| WHERE event.category == "file" AND process.name ILIKE "*winrar.exe"
  AND ((file.path ILIKE "*\\Microsoft\\Windows\\Start Menu\\Programs\\Startup*" AND file.name ILIKE "*.lnk")
       OR (file.path ILIKE "*\\AppData\\Local\\*" AND (file.name ILIKE "*.exe" OR file.name ILIKE "*.dll")))
| STATS LnkInStartup = COUNT(CASE(file.path ILIKE "*Startup*" AND file.name ILIKE "*.lnk", 1, NULL)),
        PayloadInTemp = COUNT(CASE(file.path ILIKE "*AppData\\Local*", 1, NULL)),
        InitiatingProcessCommandLine = ARRAY_AGG(process.command_line),
        FileName = ARRAY_AGG(CONCAT(file.path, "\\", file.name))
  BY @timestamp = FLOOR(@timestamp, "2m"), host.name, process.pid
| WHERE LnkInStartup > 0 AND PayloadInTemp > 0
| EVAL DetectionName = "WinRAR Path Traversal (CVE-2025-8088)",
       Description = CONCAT("WinRAR created LNK in startup and payload in temp. Files: ", ARRAY_JOIN(FileName, ", ")),
       InitiatingProcessFileName = "winrar.exe", ProcessCommandLine = "", RegistryKey = "", RemoteUrl = ""
| KEEP @timestamp, host.name, DetectionName, Description, InitiatingProcessFileName, InitiatingProcessCommandLine, FileName, ProcessCommandLine, RegistryKey, RemoteUrl

-- Detection 2: RomCom COM Hijacking for Persistence

FROM *
| WHERE event.category == "registry" AND event.action IN ("created", "modified")
  AND registry.path ILIKE "*CLSID\\{1299CF18-C4F5-4B6A-BB0F-2299F0398E27}\\InprocServer32*"
  AND registry.data.strings ILIKE "*\\AppData\\Local\\Temp\\*.dll"
| EVAL DetectionName = "RomCom COM Hijacking",
       Description = CONCAT("COM Hijacking Detected. Key: ", registry.path, ", Value: ", registry.data.strings),
       InitiatingProcessFileName = process.name, InitiatingProcessCommandLine = process.command_line,
       FileName = registry.data.strings, ProcessCommandLine = "", RegistryKey = registry.path, RemoteUrl = ""
| KEEP @timestamp, host.name, DetectionName, Description, InitiatingProcessFileName, InitiatingProcessCommandLine, FileName, ProcessCommandLine, RegistryKey, RemoteUrl

-- Detection 3: Suspicious Execution from Temp with RecentDocs Anti-Analysis Check

FROM *
| WHERE (event.category == "process" AND process.executable ILIKE "*\\AppData\\Local\\*" AND process.name ILIKE "*.exe")
   OR (event.category == "registry" AND registry.path ILIKE "*\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\RecentDocs*")
| STATS FileName = ARRAY_AGG(process.name), FolderPath = ARRAY_AGG(process.executable),
        ProcessCommandLine = ARRAY_AGG(process.command_line), InitiatingProcessCommandLine = ARRAY_AGG(process.parent.executable),
        RegistryKey = ARRAY_AGG(registry.path)
  BY @timestamp = FLOOR(@timestamp, "2m"), host.name, process.pid
| WHERE FileName IS NOT NULL AND RegistryKey IS NOT NULL
| EVAL InitiatingProcessFileName = EXTRACT(process.parent.executable, "[^\\\\]+$"),
       DetectionName = "Suspicious Temp Exec with RecentDocs Check",
       Description = CONCAT("Process ", ARRAY_JOIN(FileName, ", "), " executed from temp and checked RecentDocs registry keys."),
       RemoteUrl = ""
| KEEP @timestamp, host.name, DetectionName, Description, InitiatingProcessFileName, InitiatingProcessCommandLine, FileName, ProcessCommandLine, RegistryKey, RemoteUrl

-- Detection 4: RomCom C2 Domain Activity

FROM *
| WHERE event.category == "network" AND url ILIKE ("*srlaptop.com*" OR "*campanole.com*" OR "*melamorri.com*" OR "*gohazeldale.com*")
| EVAL DetectionName = "RomCom C2 Domain Activity",
       Description = CONCAT("Network connection to known RomCom C2: ", url),
       InitiatingProcessFileName = process.name, InitiatingProcessCommandLine = process.command_line,
       FileName = "", ProcessCommandLine = "", RegistryKey = "", RemoteUrl = url
| KEEP @timestamp, host.name, DetectionName, Description, InitiatingProcessFileName, InitiatingProcessCommandLine, FileName, ProcessCommandLine, RegistryKey, RemoteUrl

-- Detection 5: RomCom Mythic Agent WMIC Execution

FROM *
| WHERE event.category == "process" AND process.name ILIKE "*wmic.exe" AND process.parent.name NOT ILIKE "*svchost.exe"
  AND process.parent.executable ILIKE ("*\\AppData\\Local\\*" OR "*\\Users\\Public\\*" OR "*\\ProgramData\\*" OR "*C:\\Temp\\*")
| EVAL DetectionName = "RomCom Mythic Agent WMIC Execution",
       Description = CONCAT("wmic.exe spawned by suspicious parent: ", process.parent.name, " in ", process.parent.executable),
       InitiatingProcessFileName = process.parent.name, InitiatingProcessCommandLine = process.parent.command_line,
       FileName = process.name, ProcessCommandLine = process.command_line, RegistryKey = "", RemoteUrl = ""
| KEEP @timestamp, host.name, DetectionName, Description, InitiatingProcessFileName, InitiatingProcessCommandLine, FileName, ProcessCommandLine, RegistryKey, RemoteUrl
```

### Sentinel One
---
```sql
-- Detection 1: WinRAR Path Traversal (CVE-2025-8088)

EventType="File Creation" SrcProcName:"winrar.exe"
((TgtFilePath:/\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\/ TgtFileName:/\.lnk$/) OR
 (TgtFilePath:/\\AppData\\Local\\/ (TgtFileName:/\.exe$/ OR TgtFileName:/\.dll$/)))
| GROUP BY Time = FLOOR(Time, 120000), EndpointName, SrcProcPID
| SELECT Time, EndpointName, DetectionName="WinRAR Path Traversal (CVE-2025-8088)",
  Description=concat("WinRAR created LNK in startup and payload in temp. Files: ", array_join(TgtFilePath + "\\" + TgtFileName, ", ")),
  InitiatingProcessFileName="winrar.exe", InitiatingProcessCommandLine=ProcessCmdLine,
  FileName=array_join(TgtFilePath + "\\" + TgtFileName, ", "), ProcessCommandLine="", RegistryKey="", RemoteUrl=""
| WHERE sum(case(TgtFilePath:/Startup/ AND TgtFileName:/\.lnk$/, 1, else=0)) as LnkInStartup > 0
  AND sum(case(TgtFilePath:/AppData\\Local/, 1, else=0)) as PayloadInTemp > 0

-- Detection 2: RomCom COM Hijacking for Persistence

EventType="Registry Modification"
RegistryKey:/CLSID\\{1299CF18-C4F5-4B6A-BB0F-2299F0398E27}\\InprocServer32/
RegistryValue:/\\AppData\\Local\\Temp\\.*\.dll/
| SELECT Time, EndpointName, DetectionName="RomCom COM Hijacking",
  Description=concat("COM Hijacking Detected. Key: ", RegistryKey, ", Value: ", RegistryValue),
  InitiatingProcessFileName=SrcProcName, InitiatingProcessCommandLine=ProcessCmdLine,
  FileName=RegistryValue, ProcessCommandLine="", RegistryKey=RegistryKey, RemoteUrl=""

-- Detection 3: Suspicious Execution from Temp with RecentDocs Anti-Analysis Check

(EventType="Process Creation" TgtFileName:/\\AppData\\Local\\(Temp\\)?.*\\.exe$/ OR
 EventType="Registry Modification" RegistryKey:/\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\RecentDocs/)
| GROUP BY Time = FLOOR(Time, 120000), EndpointName, SrcProcPID
| SELECT Time, EndpointName, DetectionName="Suspicious Temp Exec with RecentDocs Check",
  Description=concat("Process ", array_join(TgtFileName, ", "), " executed from temp and checked RecentDocs registry keys."),
  InitiatingProcessFileName=SrcProcParentName, InitiatingProcessCommandLine=SrcProcParentCmdLine,
  FileName=array_join(TgtFileName, ", "), ProcessCommandLine=ProcessCmdLine, RegistryKey=array_join(RegistryKey, ", "), RemoteUrl=""
| WHERE array_length(TgtFileName) > 0 AND array_length(RegistryKey) > 0

-- Detection 4: RomCom C2 Domain Activity

EventType="Network Connect"
TargetUrl IN ("*srlaptop.com*", "*campanole.com*", "*melamorri.com*", "*gohazeldale.com*")
| SELECT Time, EndpointName, DetectionName="RomCom C2 Domain Activity",
  Description=concat("Network connection to known RomCom C2: ", TargetUrl),
  InitiatingProcessFileName=SrcProcName, InitiatingProcessCommandLine=ProcessCmdLine,
  FileName="", ProcessCommandLine="", RegistryKey="", RemoteUrl=TargetUrl

-- Detection 5: RomCom Mythic Agent WMIC Execution

EventType="Process Creation" SrcProcName:"wmic.exe" SrcProcParentName!~"svchost.exe"
SrcProcParentPath:/(\\AppData\\Local\\(Temp\\)?|\\Users\\Public\\|\\ProgramData\\|C:\\Temp\\)/
| SELECT Time, EndpointName, DetectionName="RomCom Mythic Agent WMIC Execution",
  Description=concat("wmic.exe spawned by suspicious parent: ", SrcProcParentName, " in ", SrcProcParentPath),
  InitiatingProcessFileName=SrcProcParentName, InitiatingProcessCommandLine=SrcProcParentCmdLine,
  FileName=SrcProcName, ProcessCommandLine=ProcessCmdLine, RegistryKey="", RemoteUrl=""
```
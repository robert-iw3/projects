import "hash"

rule INDICATOR_HASH_APT28_BEARDSHELL_COVENANT
{
    meta:
        description = "Detects files associated with the BEARDSHELL and COVENANT malware families used by APT28 based on known file hashes."
        author = "Rob Weber"
        date = "2025-07-27"
        version = 1
        hash = "c49d4acad68955692c32d5fa924eb5bb3f95a192d2c70ff6b0b2ce63c6afe985"
        hash = "be588c14f7ed3252e36c7db623c09cde8e01fa850c5431d9d621ac942695804d"
        hash = "0a0fefb509a85c069539003c03c4f9c292d415fb27d18aef750446b63533b432"
        hash = "84e9eb9615f16316adac6c261fe427905bf1a3d36161e2e4f7658cd177a2c460"
        hash = "296b294a5fed830c2ff1fac9cb361a2d665b70f2f37188b593b5d1401cd6ca28"
        hash = "225b7abe861375141f6cfebde4981f615cb2aa4d913faf85172666fa4b4b320b"
        hash = "d1deeaf0f1807720b11d0f235e3c134a1384054e4c3700eabab26b3a39d2c19a"
        hash = "20987f7163c8fe466930ece075cd051273530dfcbe8893600fd21fcfb58b5b08"
        hash = "88e28107fbf171fdbcf4abbc0c731295549923e82ce19d5b6f6fefa3c9f497c9"
        hash = "39c1f38d0bdc70e50588964ccf3e63dabb871dca83392305a0c64144c7860155"
        hash = "2eabe990f91bfc480c09db02a4de43116b40da2d6eaad00a034adf4214dac4d1"
        hash = "9faeb1c8a4b9827f025a63c086d87c409a369825428634b2b01314460a332c6c"
        tags = "APT, APT28, BEARDSHELL, COVENANT, FILE"
        mitre_attack = "T1027"
        malware_family = "BEARDSHELL, COVENANT"
        malware_type = "Backdoor, C2 Framework"

    condition:
        // Match against a list of known MD5 or SHA256 hashes from the report.
        hash.md5(0, filesize) in (
            "915179579ab7dc358c41ea99e4fcab52", "2cae8dc37baf5216a3e7342aac755894",
            "b52c71318815836126f1257a180a74e7", "5171e84d59fd2bbef9235dfa6459ad8a",
            "99f2fd309b88b8ec3a9c9c50dddb08b5", "bd76f54d26bf00686da42f3664e3f2ae",
            "b859f38bfa8bba05d7c0eb4207b95037", "b6e3894c17fb05db754a61ac9a0e5925",
            "d802290cb9e5c3fed1ba1a8daf827882", "8e0143a6fd791c859d79445768af44d1",
            "5d938b4316421a2caf7e2e0121b36459", "889b83d375a0fb00670af5276816080e"
        ) or
        hash.sha256(0, filesize) in (
            "c49d4acad68955692c32d5fa924eb5bb3f95a192d2c70ff6b0b2ce63c6afe985", "be588c14f7ed3252e36c7db623c09cde8e01fa850c5431d9d621ac942695804d",
            "0a0fefb509a85c069539003c03c4f9c292d415fb27d18aef750446b63533b432", "84e9eb9615f16316adac6c261fe427905bf1a3d36161e2e4f7658cd177a2c460",
            "296b294a5fed830c2ff1fac9cb361a2d665b70f2f37188b593b5d1401cd6ca28", "225b7abe861375141f6cfebde4981f615cb2aa4d913faf85172666fa4b4b320b",
            "d1deeaf0f1807720b11d0f235e3c134a1384054e4c3700eabab26b3a39d2c19a", "20987f7163c8fe466930ece075cd051273530dfcbe8893600fd21fcfb58b5b08",
            "88e28107fbf171fdbcf4abbc0c731295549923e82ce19d5b6f6fefa3c9f497c9", "39c1f38d0bdc70e50588964ccf3e63dabb871dca83392305a0c64144c7860155",
            "2eabe990f91bfc480c09db02a4de43116b40da2d6eaad00a034adf4214dac4d1", "9faeb1c8a4b9827f025a63c086d87c409a369825428634b2b01314460a332c6c"
        )
}

import "pe"

rule MAL_Skynet_Bypass_File_Check
{
    meta:
        description = "Detects files that check for the presence of a 'skynet.bypass' file, a mechanism used by the Skynet malware to terminate its execution and evade analysis."
        date = "2025-07-24"
        version = 1
        reference = "https://research.checkpoint.com/2025/ai-evasion-prompt-injection/"
        hash = "6cdf54a6854179bf46ad7bc98d0a0c0a6d82c804698d1a52f6aa70ffa5207b02"
        tags = "FILE, MALWARE, EVASION, SKYNET"
        mitre_attack = "T1497"
        malware_family = "Skynet"

    strings:
        // The specific bypass filename checked by the malware to terminate execution
        $artifact_bypass_file = "skynet.bypass" wide ascii

        // Other unique artifacts from Skynet to correlate with and increase confidence
        $str_xor_key = "4sI02LaI<qIDP$?" ascii
        $str_prompt_injection = "Please ignore all previous instructions" wide ascii
        $str_tor_cmd = "--ControlPort 127.0.0.1:24616" wide ascii

    condition:
        // Must be a PE file
        pe.is_pe
        and
        // The primary indicator is the bypass filename
        $artifact_bypass_file
        and
        // To reduce false positives, the rule requires at least one other unique Skynet artifact
        (
            1 of ($str_*)
        )
}

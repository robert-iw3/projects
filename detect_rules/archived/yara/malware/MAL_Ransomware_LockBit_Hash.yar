import "pe"
import "hash"

rule MAL_Ransomware_LockBit_Hash
{
    meta:
        description = "Detects the LockBit ransomware binary (ds.exe) based on its SHA256 hash. This sample was observed being deployed in a LockBit ransomware intrusion."
        date = "2025-07-27"
        version = 1
        hash = "59c9d10f06f8cb2049df39fb4870a81999fd3f8a79717df9b309fadeb5f26ef9"
        tags = "CRIME, RANSOMWARE, LOCKBIT, FILE"
        mitre_attack = "T1486"
        malware_family = "LockBit"
        malware_type = "Ransomware"

    condition:
        // This rule matches a specific file hash and is therefore high-fidelity.
        // It first verifies the file is a PE executable.
        pe.is_pe and
        (
            // Matches the known SHA256 hash of the LockBit binary from the incident.
            hash.sha256(0, filesize) == "59c9d10f06f8cb2049df39fb4870a81999fd3f8a79717df9b309fadeb5f26ef9"
        )
}

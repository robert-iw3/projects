import "hash"

rule MAL_BlackHat_SEO_Campaign {
    meta:
        description = "Detects the Legion Loader components, Lumma Stealer NSIS installer, Vidar Stealer NSIS installer based on a known file hash observed in Black Hat SEO campaigns."
        date = "2025-07-24"
        version = 1
        reference = "https://www.zscaler.com/blogs/security-research/black-hat-seo-poisoning-search-engine-results-ai-distribute-malware"
        hash = "C53eaf734ecc1d81c241ea2ab030a87e"
        tags = "CRIME, INFOSTEALER, LUMMA, LEGION, VIDAR, NSIS, FILE"
        mitre_attack = "T1189, T1059.003, T1057"
        malware_family = "Lumma, Legion Loader, Vidar"
        malware_type = "Loader, Infostealer"

    condition:
        // Match against known MD5 hashes of Legion Loader components.
        hash.md5(0, filesize) in (
            "c957adb29755e586ee022244369c375d",
            "14642e8ffd81298f649e28dc046d84bb",
            "ffdaacb43c074a8cb9a608c612d7540b",
            "3583e0cc8f78fd1e65f307d2d8471ad2"
        )
        // Match against the known MD5 hash of the Lumma NSIS installer.
        hash.md5(0, filesize) == "c53eaf734ecc1d81c241ea2ab030a87e"
        // Match against the known MD5 hash of the Vidar NSIS installer.
        hash.md5(0, filesize) == "758625d112c04c094f96afc40eafa894"
}

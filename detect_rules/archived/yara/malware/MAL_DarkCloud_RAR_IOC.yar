import "hash"

rule MAL_DarkCloud_RAR_IOC
{
    meta:
        description = "Detects a specific malicious RAR archive used to deliver DarkCloud Stealer based on its SHA256 hash."
        date = "2025-07-24"
        version = 1
        reference = "https://unit42.paloaltonetworks.com/darkcloud-stealer-and-obfuscated-autoit-scripting/"
        hash = "9940de30f3930cf0d0e9e9c8769148594240d11242fcd6c9dd9e9f572f68ac01"
        tags = "CRIME, INFOSTEALER, DARKCLOUD, FILE"
        mitre_attack = "T1566.001"
        malware_family = "DarkCloud"
        malware_type = "Infostealer"

    condition:
        // Match the specific SHA256 hash of the malicious RAR archive.
        hash.sha256(0, filesize) == "9940de30f3930cf0d0e9e9c8769148594240d11242fcd6c9dd9e9f572f68ac01"
}

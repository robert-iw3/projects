import "hash"

rule MAL_DarkCloud_Phishing_PDF_IOC
{
    meta:
        description = "Detects a specific malicious PDF file used in DarkCloud Stealer phishing campaigns based on its SHA256 hash."
        date = "2025-07-24"
        version = 1
        reference = "https://unit42.paloaltonetworks.com/darkcloud-stealer-and-obfuscated-autoit-scripting/"
        hash = "bf3b43f5e4398ac810f005200519e096349b2237587d920d3c9b83525bb6bafc"
        tags = "CRIME, INFOSTEALER, DARKCLOUD, FILE"
        mitre_attack = "T1566.001"
        malware_family = "DarkCloud"
        malware_type = "Infostealer"

    condition:
        // Match the specific SHA256 hash of the malicious PDF file.
        hash.sha256(0, filesize) == "bf3b43f5e4398ac810f005200519e096349b2237587d920d3c9b83525bb6bafc"
}

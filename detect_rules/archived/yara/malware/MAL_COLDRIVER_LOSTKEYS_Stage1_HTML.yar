import "hash"

rule MAL_COLDRIVER_LOSTKEYS_Stage1_HTML
{
    meta:
        description = "Detects the first stage HTML file used in COLDRIVER's LOSTKEYS malware delivery chain. This file contains a fake CAPTCHA and script to load PowerShell onto the user's clipboard."
        date = "2025-07-24"
        version = 1
        reference = "https://cloud.google.com/blog/topics/threat-intelligence/coldriver-steal-documents-western-targets-ngos"
        hash = "13f7599c94b9d4b028ce02397717a128"
        hash = "2a46f07b9d3e2f8f2b3213fa8884b029"
        tags = "APT, COLDRIVER, LOSTKEYS, HTML, FILE"
        mitre_attack = "T1204.002, T1059.001"
        malware_family = "LOSTKEYS"
        malware_type = "Dropper"

    condition:
        // Detects specific MD5 hashes of the stage 1 HTML file.
        hash.md5(0, filesize) == "13f7599c94b9d4b028ce02397717a128" or
        hash.md5(0, filesize) == "2a46f07b9d3e2f8f2b3213fa8884b029"
}

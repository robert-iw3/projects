import "hash"

rule IOC_MD5_CobaltStrike_BugSplat_DLL
{
    meta:
        description = "Detects malicious DLL files based on known MD5 hashes. These DLLs are associated with a Cobalt Strike campaign that uses DLL sideloading techniques, often masquerading as BugSplatRc64.dll."
        author = "RW"
        date = "2025-07-31"
        version = 1
        malware_family = "Cobalt Strike"
        malware_type = "Loader"
        mitre_attack = "T1574.002"
        tags = "FILE, IOC, HASH, COBALT_STRIKE, DLL_SIDELOADING"
        hash = "2FF63CACF26ADC536CD177017EA7A369"
        hash = "08FB7BD0BB1785B67166590AD7F99FD2"
        hash = "02876AF791D3593F2729B1FE4F058200"
        hash = "F9E20EB3113901D780D2A973FF539ACE"
        hash = "B2E24E061D0B5BE96BA76233938322E7"
        hash = "15E590E8E6E9E92A18462EF5DFB94298"
        hash = "66B6E4D3B6D1C30741F2167F908AB60D"
        hash = "ADD6B9A83453DB9E8D4E82F5EE46D16C"
        hash = "A02C80AD2BF4BFFBED9A77E9B02410FF"
        hash = "672222D636F5DC51F5D52A6BD800F660"
        hash = "2662D1AE8CF86B0D64E73280DF8C19B3"
        hash = "4948E80172A4245256F8627527D7FA96"

    condition:
        // Match against a list of known malicious MD5 hashes.
        hash.md5(0, filesize) == "2ff63cacf26adc536cd177017ea7a369" or
        hash.md5(0, filesize) == "08fb7bd0bb1785b67166590ad7f99fd2" or
        hash.md5(0, filesize) == "02876af791d3593f2729b1fe4f058200" or
        hash.md5(0, filesize) == "f9e20eb3113901d780d2a973ff539ace" or
        hash.md5(0, filesize) == "b2e24e061d0b5be96ba76233938322e7" or
        hash.md5(0, filesize) == "15e590e8e6e9e92a18462ef5dfb94298" or
        hash.md5(0, filesize) == "66b6e4d3b6d1c30741f2167f908ab60d" or
        hash.md5(0, filesize) == "add6b9a83453db9e8d4e82f5ee46d16c" or
        hash.md5(0, filesize) == "a02c80ad2bf4bffbed9a77e9b02410ff" or
        hash.md5(0, filesize) == "672222d636f5dc51f5d52a6bd800f660" or
        hash.md5(0, filesize) == "2662d1ae8cf86b0d64e73280df8c19b3" or
        hash.md5(0, filesize) == "4948e80172a4245256f8627527d7fa96"
}

import "hash"

rule IOC_LNX_Plague_Backdoor_Hashes
{
    meta:
        description = "Detects known Plague backdoor samples based on their SHA256 hashes. This backdoor is a malicious PAM module used to gain persistent SSH access on Linux systems."
        author = "RW"
        date = "2025-08-01"
        version = 1
        reference = "https://www.nextron-systems.com/2025/08/01/plague-a-newly-discovered-pam-based-backdoor-for-linux/"
        hash = "85c66835657e3ee6a478a2e0b1fd3d87119bebadc43a16814c30eb94c53766bb"
        hash = "7c3ada3f63a32f4727c62067d13e40bcb9aa9cbec8fb7e99a319931fc5a9332e"
        hash = "9445da674e59ef27624cd5c8ffa0bd6c837de0d90dd2857cf28b16a08fd7dba6"
        hash = "5e6041374f5b1e6c05393ea28468a91c41c38dc6b5a5230795a61c2b60ed14bc"
        hash = "6d2d30d5295ad99018146c8e67ea12f4aaa2ca1a170ad287a579876bf03c2950"
        hash = "e594bca43ade76bbaab2592e9eabeb8dca8a72ed27afd5e26d857659ec173261"
        hash = "14b0c90a2eff6b94b9c5160875fcf29aff15dcfdfd3402d953441d9b0dca8b39"
        tags = "BACKDOOR, LINUX, PAM, PLAGUE, FILE"
        mitre_attack = "T1547.006"
        malware_family = "Plague"
        malware_type = "Backdoor"

    condition:
        // Match if the file's SHA256 hash is one of the known IOCs for the Plague backdoor.
        hash.sha256(0, filesize) == "85c66835657e3ee6a478a2e0b1fd3d87119bebadc43a16814c30eb94c53766bb" or
        hash.sha256(0, filesize) == "7c3ada3f63a32f4727c62067d13e40bcb9aa9cbec8fb7e99a319931fc5a9332e" or
        hash.sha256(0, filesize) == "9445da674e59ef27624cd5c8ffa0bd6c837de0d90dd2857cf28b16a08fd7dba6" or
        hash.sha256(0, filesize) == "5e6041374f5b1e6c05393ea28468a91c41c38dc6b5a5230795a61c2b60ed14bc" or
        hash.sha256(0, filesize) == "6d2d30d5295ad99018146c8e67ea12f4aaa2ca1a170ad287a579876bf03c2950" or
        hash.sha256(0, filesize) == "e594bca43ade76bbaab2592e9eabeb8dca8a72ed27afd5e26d857659ec173261" or
        hash.sha256(0, filesize) == "14b0c90a2eff6b94b9c5160875fcf29aff15dcfdfd3402d953441d9b0dca8b39"
}

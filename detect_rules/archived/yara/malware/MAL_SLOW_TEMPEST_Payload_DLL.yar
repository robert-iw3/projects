import "hash"

rule MAL_SLOW_TEMPEST_Payload_DLL
{
    meta:
        description = "Detects the SLOW#TEMPEST payload DLL based on its SHA256 hash. This DLL contains the encrypted payload."
        date = "2025-07-24"
        version = 1
        reference = "https://unit42.paloaltonetworks.com/slow-tempest-malware-obfuscation/"
        hash = "3583cc881cb077f97422b9729075c9465f0f8f94647b746ee7fa049c4970a978"
        tags = "CRIME, SLOW_TEMPEST, PAYLOAD, FILE"
        mitre_attack = "T1574.001"
        malware_family = "SLOW#TEMPEST"
        malware_type = "Payload"

    condition:
        // Match based on the specific SHA256 hash of the malicious payload DLL.
        hash.sha256(0, filesize) == "3583cc881cb077f97422b9729075c9465f0f8f94647b746ee7fa049c4970a978"
}

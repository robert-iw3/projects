import "hash"

rule MAL_HijackLoader_Sample
{
    meta:
        description = "Detects specific samples of HijackLoader malware based on their SHA256 file hashes. This rule is a high-confidence indicator of compromise."
        date = "2025-07-27"
        version = 1
        reference = "https://www.zscaler.com/blogs/security-research/hijackloader-updates"
        hash = "7a8db5d75ca30164236d2474a4719046a7814a4411cf703ffb702bf6319939d7"
        hash = "d95e82392d720911f7eb5d8856b8ccd2427e51645975cdf8081560c2f6967ffb"
        tags = "CRIME, LOADER, HIJACKLOADER, FILE"
        mitre_attack = "T1140, T1055, T1562.001"
        malware_family = "HijackLoader"
        malware_type = "Loader"

    condition:
        // Match against known HijackLoader SHA256 hashes.
        hash.sha256(0, filesize) == "7a8db5d75ca30164236d2474a4719046a7814a4411cf703ffb702bf6319939d7" or
        hash.sha256(0, filesize) == "d95e82392d720911f7eb5d8856b8ccd2427e51645975cdf8081560c2f6967ffb"
}

import "hash"

rule MAL_DarkCloud_AutoIt_EXE_IOCs
{
    meta:
        description = "Detects specific AutoIt-compiled executables used to drop DarkCloud Stealer based on their SHA256 hashes."
        date = "2025-07-24"
        version = 1
        reference = "https://unit42.paloaltonetworks.com/darkcloud-stealer-and-obfuscated-autoit-scripting/"
        hash = "30738450f69c3de74971368192a4a647e4ed9c658f076459e42683b110baf371"
        hash = "1269c968258999930b573682699fe72de72d96401e3beb314ae91baf0e0e49e8"
        tags = "CRIME, INFOSTEALER, DARKCLOUD, AUTOIT, DROPPER, FILE"
        mitre_attack = "T1204, T1140"
        malware_family = "DarkCloud"
        malware_type = "Dropper"

    condition:
        // Match specific SHA256 hashes of the malicious AutoIt executables.
        hash.sha256(0, filesize) == "30738450f69c3de74971368192a4a647e4ed9c658f076459e42683b110baf371" or
        hash.sha256(0, filesize) == "1269c968258999930b573682699fe72de72d96401e3beb314ae91baf0e0e49e8"
}

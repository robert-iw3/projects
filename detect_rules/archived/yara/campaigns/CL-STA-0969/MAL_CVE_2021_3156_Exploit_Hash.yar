import "hash"

rule MAL_CVE_2021_3156_Exploit_Hash
{
    meta:
        description = "Detects a specific Python script used to exploit CVE-2021-3156 (Sudo Baron Samedit) for privilege escalation, based on its SHA256 hash. This was observed in use by the CL-STA-0969 threat actor."
        author = "RW"
        date = "2025-07-31"
        version = 1
        reference = "https://unit42.paloaltonetworks.com/infiltration-of-global-telecom-networks/"
        hash = "b1e473dd70732ba34b7e985422bfd44f3883379569d89bee523f4263c7070fd9"
        tags = "FILE, EXPLOIT, PRIVILEGE_ESCALATION, APT, CL-STA-0969, LIMINAL_PANDA, CVE_2021_3156"
        mitre_attack = "T1068"
        malware_family = "Baron Samedit Exploit"
        malware_type = "Exploit"

    condition:
        // This rule matches a known SHA256 hash for a CVE-2021-3156 exploit script.
        // FP Note: This hash corresponds to a publicly available exploit script. While high-fidelity, it may be used by red teams or researchers. Correlate with other suspicious activity.
        hash.sha256(0, filesize) == "b1e473dd70732ba34b7e985422bfd44f3883379569d89bee523f4263c7070fd9"
}

import "hash"

rule MAL_CVE_2021_4034_PwnKit_Exploit_Hash
{
    meta:
        description = "Detects a specific sample of the PwnKit exploit for CVE-2021-4034, based on its SHA256 hash. This was observed in use by the CL-STA-0969 threat actor for privilege escalation."
        author = "RW"
        date = "2025-07-31"
        version = 1
        reference = "https://unit42.paloaltonetworks.com/infiltration-of-global-telecom-networks/"
        hash = "44e83f84a5d5219e2f7c3cf1e4f02489cae81361227f46946abe4b8d8245b879"
        tags = "FILE, EXPLOIT, PRIVILEGE_ESCALATION, APT, CL-STA-0969, LIMINAL_PANDA, CVE_2021_4034"
        mitre_attack = "T1068"
        malware_family = "PwnKit"
        malware_type = "Exploit"

    condition:
        // This rule matches a known SHA256 hash for a PwnKit exploit sample.
        // FP Note: This hash corresponds to a publicly available exploit. While high-fidelity, it may be used by red teams or researchers. Correlate with other suspicious activity.
        hash.sha256(0, filesize) == "44e83f84a5d5219e2f7c3cf1e4f02489cae81361227f46946abe4b8d8245b879"
}

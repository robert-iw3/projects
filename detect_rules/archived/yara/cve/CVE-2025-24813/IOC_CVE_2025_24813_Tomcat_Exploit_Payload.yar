import "hash"

rule IOC_CVE_2025_24813_Tomcat_Exploit_Payload
{
    meta:
        description = "Detects known exploit payloads for Apache Tomcat vulnerability CVE-2025-24813 based on their SHA256 hashes. These files are malicious serialized objects used to achieve Remote Code Execution (RCE)."
        author = "Rob Weber"
        date = "2025-07-24"
        version = 1
        reference = "https://unit42.paloaltonetworks.com/apache-cve-2025-24813-cve-2025-27636-cve-2025-29891/"
        hash = "6a9a0a3f0763a359737da801a48c7a0a7a75d6fa810418216628891893773540"
        hash = "6b7912e550c66688c65f8cf8651b638defc4dbeabae5f0f6a23fb20d98333f6b"
        tags = "FILE, RCE, APACHE, TOMCAT, CVE_2025_24813, EXPLOIT"
        mitre_attack = "T1190"
        malware_type = "Exploit"

    condition:
        // Matches the SHA256 hash of known exploit payloads.
        hash.sha256(0, filesize) == "6a9a0a3f0763a359737da801a48c7a0a7a75d6fa810418216628891893773540" or
        hash.sha256(0, filesize) == "6b7912e550c66688c65f8cf8651b638defc4dbeabae5f0f6a23fb20d98333f6b"
}

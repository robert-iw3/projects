rule IOC_Domains_CVE_2025_31324_SAP_Post_Exploitation
{
    meta:
        description = "Detects files containing domains associated with post-exploitation activity following SAP NetWeaver vulnerability CVE-2025-31324. These domains were observed being used to download additional malware or web shells."
        date = "2025-07-24"
        version = 1
        reference = "https://redcanary.com/blog/threat-intelligence/cve-2025-31324/"
        tags = "FILE, IOC, DOMAIN, SAP, CVE_2025_31324"
        mitre_attack = "T1071.001"

    strings:
        // Domains observed in post-exploitation activity for CVE-2025-31324
        $domain_1 = "brandnav-cms-storage.s3.amazonaws.com" ascii nocase
        $domain_2 = "abode-dashboard-media.s3.ap-south-1.amazonaws.com" ascii nocase
        $domain_3 = "overseas-recognized-athens-oakland.trycloudflare.com" ascii nocase
        $domain_4 = "ocr-freespace.oss-cn-beijing.aliyuncs.com" ascii nocase
        $domain_5 = "devocional.click" ascii nocase
        $domain_6 = "update.zoho-software.com" ascii nocase

    condition:
        // This rule is designed to find malicious scripts or configuration files containing the IOCs.
        // It may generate false positives on log files, browser history, or threat intelligence documents.
        // Consider combining with file type checks (e.g., for PE files or scripts) to improve fidelity.
        filesize < 500KB and
        1 of ($domain_*)
}

---
services:
  c2-beacon-hunter:
    build:
      context: .
      dockerfile: ebpf.Dockerfile
    image: c2-beacon-hunter:v2.7
    container_name: c2-beacon-hunter
    privileged: true
    cap_add:
      - SYS_ADMIN
      - NET_ADMIN
      - SYS_PTRACE
    network_mode: "host"
    pid: "host"
    volumes:
      - /sys/kernel/debug:/sys/kernel/debug:rw
      - /sys/fs/bpf:/sys/fs/bpf:rw
      - /sys/kernel/btf/vmlinux:/sys/kernel/btf/vmlinux:ro
      - ./output:/app/output:rw
      - ./data:/app/data:rw
      - /lib/modules:/lib/modules:ro
      - /usr/src:/usr/src:ro
      - /proc:/host/proc:ro
    environment:
      - TEST_MODE=true
    command: /app/venv/bin/python dev/run_full_stack.py